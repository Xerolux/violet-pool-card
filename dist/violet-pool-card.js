import{LitElement as e,html as t,css as i}from"lit";import{property as a,customElement as s,state as o}from"lit/decorators.js";function r(e,t,i,a){var s,o=arguments.length,r=o<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,a);else for(var n=e.length-1;n>=0;n--)(s=e[n])&&(r=(o<3?s(r):o>3?s(t,i,r):s(t,i))||r);return o>3&&r&&Object.defineProperty(t,i,r),r}"function"==typeof SuppressedError&&SuppressedError;const n={off:{color:"#757575",icon:"mdi:power-off",label:"OFF"},on:{color:"#4CAF50",icon:"mdi:power-on",label:"ON"},auto:{color:"#2196F3",icon:"mdi:autorenew",label:"AUTO"},manual:{color:"#FF9800",icon:"mdi:hand-back-right",label:"MANUAL"},blocked:{color:"#FFC107",icon:"mdi:block-helper",label:"BLOCKED"},error:{color:"#F44336",icon:"mdi:alert-circle",label:"ERROR"},idle:{color:"#9E9E9E",icon:"mdi:sleep",label:"IDLE"},heat:{color:"#FF5722",icon:"mdi:fire",label:"HEAT"},heating:{color:"#FF5722",icon:"mdi:fire",label:"HEATING"},cool:{color:"#00BCD4",icon:"mdi:snowflake",label:"COOL"},cooling:{color:"#00BCD4",icon:"mdi:snowflake",label:"COOLING"}};let c=class extends e{constructor(){super(...arguments),this.pulse=!1,this.showIcon=!0}render(){const e=n[this.state]||n.off;return t` <div class="badge ${this.state} ${this.pulse?"pulse":""}" style="--badge-color: ${e.color}" > ${this.showIcon?t`<ha-icon icon="${this.icon||e.icon}"></ha-icon>`:""}
        <span class="label">${this.label||e.label}</span>
      </div>
    `}static get styles(){return i`:host{display:inline-block}.badge{display:inline-flex;align-items:center;justify-content:center;gap:6px;padding:6px 14px;border-radius:16px;background:var(--badge-color);color:white;font-size:12px;font-weight:600;text-transform:uppercase;letter-spacing:0.5px;white-space:nowrap;box-shadow:0 2px 4px rgba(0,0,0,0.1);transition:all 0.2s ease}.badge:hover{transform:translateY(-1px);box-shadow:0 3px 6px rgba(0,0,0,0.15)}.badge ha-icon{--mdc-icon-size:16px;display:flex;align-items:center}.label{line-height:1}.badge.pulse{animation:pulse 2s ease-in-out infinite}@keyframes pulse{0%,100%{opacity:1;transform:scale(1)}50%{opacity:0.85;transform:scale(1.02)}}.badge.auto ha-icon{animation:rotate 3s linear infinite}@keyframes rotate{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}.badge.heating,.badge.cooling{animation:breathe 2s ease-in-out infinite}@keyframes breathe{0%,100%{opacity:1}50%{opacity:0.7}}`}};r([a()],c.prototype,"state",void 0),r([a()],c.prototype,"label",void 0),r([a()],c.prototype,"icon",void 0),r([a({type:Boolean})],c.prototype,"pulse",void 0),r([a({type:Boolean})],c.prototype,"showIcon",void 0),c=r([s("status-badge")],c);const l={normal:{color:"#4CAF50",icon:"mdi:check-circle"},ok:{color:"#4CAF50",icon:"mdi:check-circle"},low:{color:"#2196F3",icon:"mdi:arrow-down-circle"},high:{color:"#FF9800",icon:"mdi:arrow-up-circle"},critical:{color:"#F44336",icon:"mdi:alert-circle"},warning:{color:"#FF9800",icon:"mdi:alert"},error:{color:"#F44336",icon:"mdi:close-circle"}};let d=class extends e{constructor(){super(...arguments),this.unit="",this.label="",this.status="normal",this.decimals=1,this.showStatus=!0,this.showRange=!1,this.large=!1}formatValue(e){return null==e?"--":e.toFixed(this.decimals)}getStatusFromValue(){return null==this.value?"normal":"normal"!==this.status?this.status:void 0!==this.min&&this.value<this.min?this.value<.9*this.min?"critical":"low":void 0!==this.max&&this.value>this.max?this.value>1.1*this.max?"critical":"high":"normal"}render(){const e=this.getStatusFromValue(),i=l[e];return t` <div class="value-display ${this.large?"large":""}"> ${this.label?t`<div class="label">${this.label}</div>`:""}

        <div class="value-container">
          <div class="value" style="color: ${i.color}">
            ${this.formatValue(this.value)}
            ${this.unit?t`<span class="unit">${this.unit}</span>`:""}
          </div>

          ${this.showStatus?t` <ha-icon icon="${i.icon}" style="color: ${i.color}" ></ha-icon> `:""}
        </div>

        ${void 0!==this.target?t` <div class="target"> → ${this.formatValue(this.target)}${this.unit} </div> `:""}

        ${!this.showRange||void 0===this.min&&void 0===this.max?"":t` <div class="range"> ${void 0!==this.min?t`<span class="range-min">Min: ${this.formatValue(this.min)}${this.unit}</span>`:""}
                ${void 0!==this.max?t`<span class="range-max">Max: ${this.formatValue(this.max)}${this.unit}</span>`:""}
              </div>
            `}
      </div>
    `}static get styles(){return i`:host{display:block}.value-display{display:flex;flex-direction:column;gap:4px}.label{font-size:12px;font-weight:500;color:var(--secondary-text-color);text-transform:uppercase;letter-spacing:0.5px}.value-container{display:flex;align-items:center;gap:8px}.value{font-size:24px;font-weight:700;line-height:1;color:var(--primary-text-color);display:flex;align-items:baseline;gap:4px}.value-display.large .value{font-size:32px;font-weight:800}.unit{font-size:16px;font-weight:500;opacity:0.8}.value-display.large .unit{font-size:20px}ha-icon{--mdc-icon-size:20px;flex-shrink:0}.target{font-size:14px;color:var(--secondary-text-color);display:flex;align-items:center;gap:4px}.range{display:flex;gap:12px;font-size:11px;color:var(--disabled-text-color);margin-top:4px}.range-min::before{content:'\\25BC ';color:var(--info-color,#2196F3)}.range-max::before{content:'\\25B2 ';color:var(--warning-color,#FF9800)}`}};r([a({type:Number})],d.prototype,"value",void 0),r([a()],d.prototype,"unit",void 0),r([a()],d.prototype,"label",void 0),r([a()],d.prototype,"status",void 0),r([a({type:Number})],d.prototype,"min",void 0),r([a({type:Number})],d.prototype,"max",void 0),r([a({type:Number})],d.prototype,"target",void 0),r([a({type:Number})],d.prototype,"decimals",void 0),r([a({type:Boolean})],d.prototype,"showStatus",void 0),r([a({type:Boolean})],d.prototype,"showRange",void 0),r([a({type:Boolean})],d.prototype,"large",void 0),d=r([s("value-display")],d);let p=class extends e{constructor(){super(...arguments),this.compact=!1}parsePipeSeparated(e){if(!e||"string"!=typeof e)return{status:""};const t=e.split("|");if(2===t.length){const e=parseInt(t[0],10),i=this.formatStatusText(t[1]);return{level:isNaN(e)?void 0:e,status:i}}return{status:this.formatStatusText(e)}}formatStatusText(e){return e?e.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join(" "):""}parseArray(e){return Array.isArray(e)?e.map(e=>this.formatStatusText(e)).filter(e=>e):[]}getIconForStatus(e){const t=e.toLowerCase();return t.includes("freeze")||t.includes("frost")?"mdi:snowflake-alert":t.includes("blocked")||t.includes("block")?"mdi:block-helper":t.includes("threshold")||t.includes("limit")?"mdi:speedometer":t.includes("temp")?"mdi:thermometer-alert":t.includes("error")?"mdi:alert-circle":t.includes("ok")||t.includes("normal")?"mdi:check-circle":"mdi:information"}getColorForStatus(e){const t=e.toLowerCase();return t.includes("error")||t.includes("critical")?"var(--error-color, #F44336)":t.includes("blocked")||t.includes("freeze")?"var(--warning-color, #FF9800)":t.includes("ok")||t.includes("normal")?"var(--success-color, #4CAF50)":"var(--info-color, #2196F3)"}render(){if(!this.raw)return t``;if(Array.isArray(this.raw)){const e=this.parseArray(this.raw);return 0===e.length?t``:t` <div class="detail-status-list ${this.compact?"compact":""}"> ${e.map(e=>t`
              <div class="status-item" style="color: ${this.getColorForStatus(e)}">
                <ha-icon icon="${this.icon||this.getIconForStatus(e)}"></ha-icon>
                <span class="status-text">${e}</span>
              </div>
            `)}
        </div>
      `}const e=this.parsePipeSeparated(this.raw);if(!e.status)return t``;const i=this.getColorForStatus(e.status),a=this.icon||this.getIconForStatus(e.status);return t` <div class="detail-status ${this.compact?"compact":""}" style="color: ${i}"><ha-icon icon="${a}"></ha-icon><div class="status-content"> ${void 0!==e.level?t`<span class="level">Level ${e.level}:</span>`:""}
          <span class="status-text">${e.status}</span>
        </div>
      </div>
    `}static get styles(){return i`:host{display:block}.detail-status{display:flex;align-items:center;gap:8px;padding:8px 12px;background:var(--card-background-color);border-radius:8px;border-left:3px solid currentColor;font-size:14px;line-height:1.4}.detail-status.compact{padding:4px 8px;font-size:12px}.detail-status ha-icon{--mdc-icon-size:20px;flex-shrink:0}.detail-status.compact ha-icon{--mdc-icon-size:16px}.status-content{display:flex;flex-wrap:wrap;align-items:center;gap:4px;flex:1}.level{font-weight:600;opacity:0.9}.status-text{font-weight:500}.detail-status-list{display:flex;flex-direction:column;gap:6px}.detail-status-list.compact{gap:4px}.status-item{display:flex;align-items:center;gap:6px;padding:6px 10px;background:var(--card-background-color);border-radius:6px;border-left:2px solid currentColor;font-size:13px}.detail-status-list.compact .status-item{padding:4px 8px;font-size:11px}.status-item ha-icon{--mdc-icon-size:16px;flex-shrink:0}.detail-status-list.compact .status-item ha-icon{--mdc-icon-size:14px}.status-item .status-text{font-weight:500}`}};r([a()],p.prototype,"raw",void 0),r([a()],p.prototype,"icon",void 0),r([a({type:Boolean})],p.prototype,"compact",void 0),p=r([s("detail-status")],p);const h={info:{color:"#2196F3",backgroundColor:"rgba(33, 150, 243, 0.1)",icon:"mdi:information"},warning:{color:"#FF9800",backgroundColor:"rgba(255, 152, 0, 0.1)",icon:"mdi:alert"},error:{color:"#F44336",backgroundColor:"rgba(244, 67, 54, 0.1)",icon:"mdi:alert-circle"},success:{color:"#4CAF50",backgroundColor:"rgba(76, 175, 80, 0.1)",icon:"mdi:check-circle"}};let g=class extends e{constructor(){super(...arguments),this.warnings=[],this.defaultType="warning",this.dismissable=!1,this.dismissedWarnings=new Set}normalizeWarnings(){return this.warnings.map(e=>"string"==typeof e?{text:this.formatWarningText(e),type:this.getWarningType(e),dismissable:this.dismissable}:{...e,text:this.formatWarningText(e.text),type:e.type||this.defaultType,dismissable:void 0!==e.dismissable?e.dismissable:this.dismissable})}formatWarningText(e){return e?e.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join(" "):""}getWarningType(e){const t=e.toLowerCase();return t.includes("error")||t.includes("critical")||t.includes("failed")?"error":t.includes("blocked")||t.includes("threshold")||t.includes("limit")?"warning":t.includes("ok")||t.includes("success")||t.includes("complete")?"success":"info"}handleDismiss(e){this.dismissedWarnings.add(e.text),this.requestUpdate(),this.dispatchEvent(new CustomEvent("warning-dismissed",{detail:{warning:e},bubbles:!0,composed:!0}))}isDismissed(e){return this.dismissedWarnings.has(e.text)}render(){const e=this.normalizeWarnings().filter(e=>!this.isDismissed(e));return 0===e.length?t``:t` <div class="warning-chips"> ${e.map(e=>this.renderChip(e))} </div> `}renderChip(e){const i=e.type||this.defaultType,a=h[i];return t` <div class="chip ${i}" style=" --chip-color: ${a.color}; --chip-bg: ${a.backgroundColor}; " ><ha-icon icon="${e.icon||a.icon}"></ha-icon><span class="chip-text">${e.text}</span> ${e.dismissable?t`
              <button
                class="dismiss-button"
                @click="${()=>this.handleDismiss(e)}"
                title="Dismiss"
              >
                <ha-icon icon="mdi:close"></ha-icon>
              </button>
            `:""}
      </div>
    `}static get styles(){return i`:host{display:block}.warning-chips{display:flex;flex-wrap:wrap;gap:8px}.chip{display:inline-flex;align-items:center;gap:6px;padding:8px 12px;border-radius:16px;background:var(--chip-bg);color:var(--chip-color);font-size:13px;font-weight:500;line-height:1.2;border:1px solid var(--chip-color);transition:all 0.2s ease}.chip:hover{transform:translateY(-1px);box-shadow:0 2px 4px rgba(0,0,0,0.1)}.chip ha-icon{--mdc-icon-size:16px;flex-shrink:0}.chip-text{flex:1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.dismiss-button{display:flex;align-items:center;justify-content:center;padding:0;margin:0;border:none;background:none;color:var(--chip-color);cursor:pointer;opacity:0.7;transition:opacity 0.2s ease}.dismiss-button:hover{opacity:1}.dismiss-button ha-icon{--mdc-icon-size:14px}.chip.error{animation:pulse-error 2s ease-in-out infinite}@keyframes pulse-error{0%,100%{opacity:1}50%{opacity:0.85}}@media(max-width:600px){.warning-chips{flex-direction:column}.chip{width:100%;box-sizing:border-box}.chip-text{white-space:normal;overflow:visible}}`}};r([a({type:Array})],g.prototype,"warnings",void 0),r([a()],g.prototype,"defaultType",void 0),r([a({type:Boolean})],g.prototype,"dismissable",void 0),r([o()],g.prototype,"dismissedWarnings",void 0),g=r([s("warning-chips")],g);let m=class extends e{constructor(){super(...arguments),this.min=0,this.max=100,this.step=1,this.value=0,this.unit="",this.label="",this.disabled=!1,this.vertical=!1,this.showValue=!0,this.showMinMax=!1,this.isDragging=!1,this.localValue=0,this.debounceDelay=300}connectedCallback(){super.connectedCallback(),this.localValue=this.value}updated(e){e.has("value")&&!this.isDragging&&(this.localValue=this.value)}handleInput(e){const t=Number(e.target.value);this.localValue=t,this.isDragging=!0,this.dispatchEvent(new CustomEvent("slider-input",{detail:{value:t},bubbles:!0,composed:!0}))}handleChange(e){const t=Number(e.target.value);this.localValue=t,this.isDragging=!1,this.debounceTimer&&clearTimeout(this.debounceTimer),this.debounceTimer=window.setTimeout(()=>{this.dispatchEvent(new CustomEvent("value-changed",{detail:{value:t},bubbles:!0,composed:!0}))},this.debounceDelay)}handleStart(){this.isDragging=!0}handleEnd(){this.isDragging=!1}getLabelForValue(e){if(!this.labels||0===this.labels.length)return"";if("string"==typeof this.labels[0])return this.labels[Math.round((e-this.min)/this.step)]||"";const t=this.labels.find(t=>t.value===e);return t?t.label:""}getAllLabels(){if(!this.labels||0===this.labels.length)return[];const e=this.max-this.min;return this.labels.map("string"==typeof this.labels[0]?(t,i)=>{const a=this.min+i*this.step;return{value:a,label:t,position:(a-this.min)/e*100}}:t=>({value:t.value,label:t.label,position:(t.value-this.min)/e*100}))}formatValue(e){return this.getLabelForValue(e)||`${e.toFixed(this.step<1?1:0)}${this.unit}`}render(){const e=(this.localValue-this.min)/(this.max-this.min)*100,i=this.getAllLabels();return t` <div class="slider-container ${this.vertical?"vertical":""} ${this.disabled?"disabled":""}"> ${this.label?t`<div class="slider-label">${this.label}</div>`:""}

        ${this.showValue?t` <div class="value-display ${this.isDragging?"dragging":""}"> ${this.formatValue(this.localValue)} </div> `:""}

        <div class="slider-wrapper">
          ${this.showMinMax?t`<span class="min-max-label">${this.formatValue(this.min)}</span>`:""}

          <div class="slider-track-wrapper">
            <input
              type="range"
              class="slider"
              min="${this.min}"
              max="${this.max}"
              step="${this.step}"
              .value="${""+this.localValue}"
              ?disabled="${this.disabled}"
              @input="${this.handleInput}"
              @change="${this.handleChange}"
              @mousedown="${this.handleStart}"
              @mouseup="${this.handleEnd}"
              @touchstart="${this.handleStart}"
              @touchend="${this.handleEnd}"
              style="--percentage: ${e}%"
            />
          </div>

          ${this.showMinMax?t`<span class="min-max-label">${this.formatValue(this.max)}</span>`:""}
        </div>

        ${i.length>0?t` <div class="labels"> ${i.map(e=>t`
                    <span
                      class="label-item ${this.localValue===e.value?"active":""}"
                      style="left: ${e.position}%"
                      @click="${()=>!this.disabled&&this.handleChange({target:{value:e.value}})}"
                    >
                      ${e.label}
                    </span>
                  `)}
              </div>
            `:""}
      </div>
    `}static get styles(){return i`:host{display:block}.slider-container{width:100%;user-select:none}.slider-container.disabled{opacity:0.5;pointer-events:none}.slider-label{font-size:12px;font-weight:500;color:var(--secondary-text-color);text-transform:uppercase;letter-spacing:0.5px;margin-bottom:8px}.value-display{text-align:center;font-size:28px;font-weight:700;margin-bottom:12px;color:var(--primary-text-color);transition:all 0.2s ease}.value-display.dragging{color:var(--primary-color);transform:scale(1.05)}.slider-wrapper{display:flex;align-items:center;gap:12px;padding:8px 0}.min-max-label{font-size:11px;color:var(--secondary-text-color);min-width:40px;text-align:center}.slider-track-wrapper{flex:1;position:relative}.slider{width:100%;height:8px;-webkit-appearance:none;appearance:none;background:linear-gradient(to right,var(--primary-color) 0%,var(--primary-color) var(--percentage),var(--disabled-color,#e0e0e0) var(--percentage),var(--disabled-color,#e0e0e0) 100%);border-radius:4px;outline:none;cursor:pointer;transition:opacity 0.2s}.slider:hover{opacity:0.9}.slider:disabled{cursor:not-allowed}.slider::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:24px;height:24px;border-radius:50%;background:var(--primary-color);cursor:pointer;box-shadow:0 2px 6px rgba(0,0,0,0.2);transition:all 0.2s ease;border:3px solid white}.slider::-webkit-slider-thumb:hover{transform:scale(1.1);box-shadow:0 3px 8px rgba(0,0,0,0.3)}.slider:active::-webkit-slider-thumb{transform:scale(1.15);box-shadow:0 4px 12px rgba(0,0,0,0.4)}.slider::-moz-range-thumb{width:24px;height:24px;border-radius:50%;background:var(--primary-color);cursor:pointer;border:3px solid white;box-shadow:0 2px 6px rgba(0,0,0,0.2);transition:all 0.2s ease}.slider::-moz-range-thumb:hover{transform:scale(1.1);box-shadow:0 3px 8px rgba(0,0,0,0.3)}.slider:active::-moz-range-thumb{transform:scale(1.15);box-shadow:0 4px 12px rgba(0,0,0,0.4)}.slider::-moz-range-track{background:transparent;border:none}.labels{position:relative;display:flex;justify-content:space-between;margin-top:12px;font-size:11px;color:var(--secondary-text-color)}.label-item{position:absolute;transform:translateX(-50%);cursor:pointer;padding:4px 8px;border-radius:4px;transition:all 0.2s ease;white-space:nowrap}.label-item:hover{background:var(--divider-color,rgba(0,0,0,0.05));color:var(--primary-text-color)}.label-item.active{font-weight:600;color:var(--primary-color)}.slider-container.vertical .slider{transform:rotate(-90deg);transform-origin:left center}@media(pointer:coarse){.slider::-webkit-slider-thumb{width:28px;height:28px}.slider::-moz-range-thumb{width:28px;height:28px}}`}};r([a({type:Number})],m.prototype,"min",void 0),r([a({type:Number})],m.prototype,"max",void 0),r([a({type:Number})],m.prototype,"step",void 0),r([a({type:Number})],m.prototype,"value",void 0),r([a()],m.prototype,"unit",void 0),r([a()],m.prototype,"label",void 0),r([a({type:Array})],m.prototype,"labels",void 0),r([a({type:Boolean})],m.prototype,"disabled",void 0),r([a({type:Boolean})],m.prototype,"vertical",void 0),r([a({type:Boolean})],m.prototype,"showValue",void 0),r([a({type:Boolean})],m.prototype,"showMinMax",void 0),r([o()],m.prototype,"isDragging",void 0),r([o()],m.prototype,"localValue",void 0),m=r([s("slider-control")],m);let u=class extends e{constructor(){super(...arguments),this.actions=[],this.vertical=!1,this.compact=!1,this.loadingStates=new Map}async handleActionClick(e,t){if(!e.disabled&&!this.loadingStates.get(t)){if(e.confirmMessage&&!await this.showConfirmation(e.confirmMessage))return;this.loadingStates.set(t,!0),this.requestUpdate();try{await e.action(),this.dispatchEvent(new CustomEvent("action-executed",{detail:{action:e,index:t},bubbles:!0,composed:!0}))}catch(i){this.dispatchEvent(new CustomEvent("action-error",{detail:{action:e,index:t,error:i},bubbles:!0,composed:!0}))}finally{this.loadingStates.set(t,!1),this.requestUpdate()}}}async showConfirmation(e){return confirm(e)}renderAction(e,i){const a=this.loadingStates.get(i)||e.loading,s=e.disabled||a;return t` <button class="quick-action ${e.active?"active":""} ${s?"disabled":""} ${a?"loading":""}" @click="${()=>this.handleActionClick(e,i)}" ?disabled="${s}" style="${e.color?"--action-color: "+e.color:""}"
        title="${e.label}"
      >
        <div class="action-content">
          ${a?t`<ha-icon icon="mdi:loading" class="spin"></ha-icon>`:t`<ha-icon icon="${e.icon}"></ha-icon>`}
          ${this.compact?"":t`<span class="action-label">${e.label}</span>`}
        </div>
      </button>
    `}render(){return 0===this.actions.length?t``:t` <div class="quick-actions ${this.vertical?"vertical":""} ${this.compact?"compact":""}"> ${this.actions.map((e,t)=>this.renderAction(e,t))} </div> `}static get styles(){return i`:host{display:block}.quick-actions{display:flex;gap:8px;flex-wrap:wrap}.quick-actions.vertical{flex-direction:column}.quick-actions.compact{gap:4px}.quick-action{flex:1;min-width:0;display:flex;align-items:center;justify-content:center;padding:12px 16px;border:2px solid var(--divider-color,rgba(0,0,0,0.12));border-radius:8px;background:var(--card-background-color,#fff);color:var(--primary-text-color);cursor:pointer;font-size:14px;font-weight:500;transition:all 0.2s ease;position:relative;overflow:hidden}.quick-actions.compact .quick-action{padding:10px;min-width:48px;min-height:48px}.quick-action:hover:not(.disabled){background:var(--divider-color,rgba(0,0,0,0.05));border-color:var(--primary-color);transform:translateY(-2px);box-shadow:0 2px 8px rgba(0,0,0,0.1)}.quick-action:active:not(.disabled){transform:translateY(0);box-shadow:0 1px 4px rgba(0,0,0,0.1)}.quick-action.active{background:var(--action-color,var(--primary-color));border-color:var(--action-color,var(--primary-color));color:white}.quick-action.active:hover:not(.disabled){background:var(--action-color,var(--primary-color));opacity:0.9}.quick-action.disabled{opacity:0.5;cursor:not-allowed}.quick-action.loading{pointer-events:none}.action-content{display:flex;align-items:center;justify-content:center;gap:8px;width:100%}.quick-actions.compact .action-content{gap:0}.quick-action ha-icon{--mdc-icon-size:20px;flex-shrink:0}.quick-actions.compact .quick-action ha-icon{--mdc-icon-size:24px}.action-label{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.spin{animation:spin 1s linear infinite}@keyframes spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}.quick-action::before{content:'';position:absolute;top:50%;left:50%;width:0;height:0;border-radius:50%;background:rgba(255,255,255,0.3);transform:translate(-50%,-50%);transition:width 0.6s,height 0.6s}.quick-action:active:not(.disabled)::before{width:200%;height:200%}@media(pointer:coarse){.quick-action{min-height:48px}}@media(max-width:600px){.quick-actions:not(.vertical){flex-direction:column}.quick-action{width:100%}}`}};r([a({type:Array})],u.prototype,"actions",void 0),r([a({type:Boolean})],u.prototype,"vertical",void 0),r([a({type:Boolean})],u.prototype,"compact",void 0),r([o()],u.prototype,"loadingStates",void 0),u=r([s("quick-actions")],u);class v{constructor(e){this.hass=e}showToast(e,t=3e3){const i=new CustomEvent("hass-notification",{detail:{message:e,duration:t},bubbles:!0,composed:!0});window.dispatchEvent(i)}async callService(e,t,i){try{return await this.hass.callService(e,t,i),{success:!0}}catch(e){const t=e instanceof Error?e.message:e+"";return this.showToast("Error: "+t,5e3),{success:!1,error:t}}}async controlPump(e,t,i,a){const s={entity_id:e,action:t};void 0!==i&&(s.speed=i),void 0!==a&&(s.duration=a);const o=await this.callService("violet_pool_controller","control_pump",s);if(o.success){const e=void 0!==i?` (Speed ${i})`:"";this.showToast(`Pump ${t.toUpperCase()}${e}`)}return o}async setTemperature(e,t){const i=await this.callService("climate","set_temperature",{entity_id:e,temperature:t});return i.success&&this.showToast(`Temperature set to ${t}°C`),i}async setHvacMode(e,t){const i=await this.callService("climate","set_hvac_mode",{entity_id:e,hvac_mode:t});return i.success&&this.showToast("HVAC mode set to "+t.toUpperCase()),i}async setNumberValue(e,t){const i=await this.callService("number","set_value",{entity_id:e,value:t});return i.success&&this.showToast("Value set to "+t),i}async turnOn(e){const t=e.split(".")[0],i=await this.callService(t,"turn_on",{entity_id:e});return i.success&&this.showToast(e.split(".")[1]+" turned ON"),i}async turnOff(e){const t=e.split(".")[0],i=await this.callService(t,"turn_off",{entity_id:e});return i.success&&this.showToast(e.split(".")[1]+" turned OFF"),i}async toggle(e){const t=e.split(".")[0],i=await this.callService(t,"toggle",{entity_id:e});return i.success&&this.showToast(e.split(".")[1]+" toggled"),i}async smartDosing(e,t,i="on"){const a=await this.callService("violet_pool_controller","smart_dosing",{dosing_type:e,duration:t,action:i});return a.success&&this.showToast(`${{cl:"Chlorine",phm:"pH-",php:"pH+",floc:"Flocculant"}[e]} dosing for ${t}s`),a}async manualDosing(e,t=30){const i=e.match(/dos_\d+_(\w+)/);if(!i)return{success:!1,error:"Could not determine dosing type from entity"};const a={cl:"cl",phm:"phm",php:"php",floc:"floc"}[i[1]];return a?this.smartDosing(a,t):{success:!1,error:"Unknown dosing type: "+i[1]}}async setPumpSpeed(e,t){return t<0||t>3?{success:!1,error:"Speed must be between 0 and 3"}:this.controlPump(e,"on",t)}async setControllerMode(e,t){return"off"===t?this.turnOff(e):this.controlPump(e,"manual"===t?"on":"auto")}}class f{static parsePumpState(e){if(!e||"string"!=typeof e)return{status:"",rawState:""};const t=e.split("|");if(2===t.length){const i=parseInt(t[0],10),a=this.formatSnakeCase(t[1]);return{level:isNaN(i)?void 0:i,status:a,rawState:e}}return{status:this.formatSnakeCase(e),rawState:e}}static parseHeaterState(e){return this.parsePumpState(e)}static parseSolarState(e){return this.parsePumpState(e)}static formatSnakeCase(e){return e?e.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join(" "):""}static getCurrentTemperature(e){const t=e?.attributes?.current_temperature;return void 0!==t?Number(t):void 0}static getTargetTemperature(e){const t=e?.attributes?.temperature;return void 0!==t?Number(t):void 0}static getMinTemperature(e){const t=e?.attributes?.min_temp;return void 0!==t?Number(t):void 0}static getMaxTemperature(e){const t=e?.attributes?.max_temp;return void 0!==t?Number(t):void 0}}class x{static getTemperatureColor(e){return e<15?{color:"#2196F3",intensity:"high"}:e<20?{color:"#00BCD4",intensity:"medium"}:e<26?{color:"#4CAF50",intensity:"low"}:e<30?{color:"#FF9800",intensity:"medium"}:{color:"#F44336",intensity:"high"}}static getPhColor(e,t=7.2){const i=Math.abs(e-t);return i<.1?{color:"#4CAF50",intensity:"low"}:i<.3?{color:"#8BC34A",intensity:"low"}:i<.5?{color:"#FF9800",intensity:"medium"}:{color:"#F44336",intensity:"high"}}static getOrpColor(e,t=700){return e<t-100?{color:"#F44336",intensity:"high"}:e<t-50?{color:"#FF9800",intensity:"medium"}:e>t+100?{color:"#F44336",intensity:"high"}:e>t+50?{color:"#FF9800",intensity:"medium"}:{color:"#4CAF50",intensity:"low"}}static getPumpSpeedColor(e){switch(e){case 0:default:return{color:"#757575",intensity:"low"};case 1:return{color:"#2196F3",intensity:"low"};case 2:return{color:"#4CAF50",intensity:"medium"};case 3:return{color:"#FF9800",intensity:"high"}}}static getEntityStateColor(e){const t=e.toLowerCase();return"on"===t||"heat"===t||"active"===t?{color:"#4CAF50",intensity:"medium"}:"off"===t||"idle"===t?{color:"#757575",intensity:"low"}:"auto"===t?{color:"#2196F3",intensity:"medium"}:"manual"===t?{color:"#FF9800",intensity:"medium"}:t.includes("blocked")||t.includes("error")?{color:"#F44336",intensity:"high"}:t.includes("warning")?{color:"#FFC107",intensity:"medium"}:{color:"#9E9E9E",intensity:"low"}}static getPercentageColor(e,t=100){const i=Math.abs(e-t);return i<10?{color:"#4CAF50",intensity:"low"}:i<25?{color:"#8BC34A",intensity:"low"}:i<50?{color:"#FF9800",intensity:"medium"}:{color:"#F44336",intensity:"high"}}static getIntensityOpacity(e){switch(e){case"low":return.15;case"medium":return.25;case"high":return.35;default:return.2}}static applyColorToElement(e,t,i=!0){if(e.style.setProperty("--state-color",t.color),i){const i=this.getIntensityOpacity(t.intensity),a=this.hexToRgb(t.color);a&&(e.style.background=`rgba(${a.r}, ${a.g}, ${a.b}, ${i})`)}}static hexToRgb(e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}}let b=class extends e{setConfig(e){if(!e.card_type)throw Error("You need to define a card_type");if("overview"!==e.card_type&&"system"!==e.card_type&&!e.entity)throw Error("You need to define an entity");this.config={show_state:!0,show_detail_status:!0,show_controls:!0,show_runtime:!1,show_history:!1,size:"medium",theme:"apple",animation:"smooth",blur_intensity:10,style:"standard",show_flow_animation:!1,entity_prefix:"violet_pool",...e}}_buildEntityId(e,t){return`${e}.${this.config.entity_prefix||"violet_pool"}_${t}`}_getEntityId(e,t,i,a){return this.config[e]||(void 0!==a&&this.config.entities&&this.config.entities[a]?this.config.entities[a]:this._buildEntityId(t,i))}_getFriendlyState(e,t){return"pump"===t&&"on"===e?"Running":{on:"Active",off:"Off",auto:"Auto",heat:"Heating",heating:"Heating",cool:"Cooling",cooling:"Cooling",idle:"Idle",unavailable:"Unavailable",unknown:"Unknown",manual:"Manual"}[e]??e.charAt(0).toUpperCase()+e.slice(1)}_getValuePercent(e,t,i){return i<=t?0:Math.min(100,Math.max(0,(e-t)/(i-t)*100))}_showMoreInfo(e){const t=new CustomEvent("hass-more-info",{detail:{entityId:e},bubbles:!0,composed:!0});this.dispatchEvent(t)}render(){if(!this.config||!this.hass)return t``;if(this.config.entity&&!this.hass.states[this.config.entity])return t` <ha-card><div class="error-state"><div class="error-icon"><ha-icon icon="mdi:alert-circle-outline"></ha-icon></div><div class="error-info"><span class="error-title">Entity Not Found</span><span class="error-entity">${this.config.entity}</span></div></div></ha-card> `;switch(this.config.card_type){case"pump":return this.renderPumpCard();case"heater":return this.renderHeaterCard();case"solar":return this.renderSolarCard();case"dosing":return this.renderDosingCard();case"overview":return this.renderOverviewCard();case"compact":return this.renderCompactCard();case"system":return this.renderSystemCard();default:return t` <ha-card><div class="error-state"><div class="error-icon"><ha-icon icon="mdi:alert-circle-outline"></ha-icon></div><div class="error-info"><span class="error-title">Unknown Card Type</span><span class="error-entity">${this.config.card_type}</span></div></div></ha-card> `}}_getCardClasses(e,t){const i=[];return i.push("size-"+(t.size||"medium")),i.push(t.theme?"theme-"+t.theme:t.style||"standard"),t.animation&&"none"!==t.animation&&i.push("animation-"+t.animation),(t.show_flow_animation||"energetic"===t.animation)&&e&&i.push("flow-active"),e&&i.push("is-active"),i.join(" ")}_getAccentColor(e,t){if(t.accent_color)return t.accent_color;switch(e){case"pump":default:return"#2196F3";case"heater":return"#FF5722";case"solar":return"#FF9800";case"dosing":return"#4CAF50";case"overview":return"#7C4DFF"}}renderSystemCard(){const e=this._getEntityId("pump_entity","switch","pump",0),i=this._getEntityId("heater_entity","climate","heater",1),a=this._getEntityId("solar_entity","climate","solar",2),s=this._getEntityId("chlorine_entity","switch","dos_1_cl",3),o=(e,t,i={})=>"overview"===e||this.hass.states[t]?{...this.config,card_type:e,entity:t,entity_prefix:this.config.entity_prefix||"violet_pool",...i}:null,r=o("overview","",{name:"Pool Overview"}),n=o("pump",e,{show_runtime:!0}),c=o("heater",i),l=o("solar",a),d=o("dosing",s,{dosing_type:"chlorine"});return t` <div class="system-grid"> ${r?this.renderOverviewCard(r):""} ${n?this.renderPumpCard(n):""} ${c?this.renderHeaterCard(c):""} ${l?this.renderSolarCard(l):""} ${d?this.renderDosingCard(d):""} </div> `}renderPumpCard(e=this.config){const i=this.hass.states[e.entity],a=i.state,s=e.name||i.attributes.friendly_name||"Pump",o=i.attributes?.PUMPSTATE||"",r=this._getAccentColor("pump",e),n=f.parsePumpState(o),c=void 0!==n.level?n.level:0,l=[i.attributes?.PUMP_RPM_0||0,i.attributes?.PUMP_RPM_1||0,i.attributes?.PUMP_RPM_2||0,i.attributes?.PUMP_RPM_3||0][c]||0,d=i.attributes?.runtime||0,p=Math.floor(d/3600),h=Math.floor(d%3600/60),g=p>0?`${p}h ${h}min`:h+"min",m=x.getPumpSpeedColor(c),u="on"===a||c>0,b=["OFF","ECO","Normal","Boost"],y=["#8E8E93","#34C759","#FF9F0A","#FF3B30"],w=["mdi:power-off","mdi:speedometer-slow","mdi:speedometer-medium","mdi:speedometer"];return t` <ha-card class="${this._getCardClasses(u,e)}" style="--card-accent: ${r}" @click="${()=>this._showMoreInfo(e.entity)}" ><div class="accent-bar"></div><div class="card-content"><div class="header"><div class="header-icon ${u?"icon-active":""}" style="--icon-accent: ${r}"><ha-icon icon="${e.icon||"mdi:pump"}" class="${u?"pump-running":""}" ></ha-icon></div><div class="header-info"><span class="name">${s}</span><span class="header-subtitle" style="${u?"color: "+m.color:""}">
                ${u?`${b[c]}${l>0?` · ${l} RPM`:""}`:this._getFriendlyState(a,"pump")}
              </span>
            </div>
            ${e.show_state?t`<status-badge .state="${a}" .pulse="${u}"></status-badge>`:""}
          </div>

          <!-- Speed Segments Visual Indicator -->
          <div class="speed-segments-container">
            <div class="speed-segments">
              ${[1,2,3].map(i=>t` <button class="speed-segment ${c===i?"seg-active":c>i?"seg-past":""}" style="--seg-color: ${y[i]}" @click="${t=>{t.stopPropagation(),new v(this.hass).setPumpSpeed(e.entity,i)}}" title="${b[i]}" ><ha-icon icon="${w[i]}" style="--mdc-icon-size: 14px"></ha-icon><span>${b[i]}</span></button> `)}
            </div>
            <button
              class="speed-off-btn ${0===c?"seg-active":""}"
              style="--seg-color: ${y[0]}"
              @click="${t=>{t.stopPropagation(),new v(this.hass).turnOff(e.entity)}}"
              title="OFF"
            >
              <ha-icon icon="mdi:power" style="--mdc-icon-size: 16px"></ha-icon>
            </button>
          </div>

          ${e.show_detail_status&&o?t`<detail-status .raw="${o}"></detail-status>`:""}

          ${e.show_controls?t` <slider-control label="Speed Level" min="0" max="3" step="1" .value="${c}" .labels="${["OFF","ECO","Normal","Boost"]}" @value-changed="${t=>this._handlePumpSpeedChange(t,e.entity)}" ></slider-control> `:""}

          ${e.show_runtime&&d>0?t` <div class="info-row"><ha-icon icon="mdi:timer-outline"></ha-icon><span class="info-label">Runtime</span><span class="info-value">${g}</span></div> `:""}
        </div>
      </ha-card>
    `}async _handlePumpSpeedChange(e,t){const i=e.detail.value,a=new v(this.hass);await a.setPumpSpeed(t,i)}renderHeaterCard(e=this.config){const i=this.hass.states[e.entity],a=i.state,s=e.name||i.attributes.friendly_name||"Heater",o=this._getAccentColor("heater",e),r=f.getCurrentTemperature(i),n=f.getTargetTemperature(i),c=f.getMinTemperature(i)||18,l=f.getMaxTemperature(i)||35,d=i.attributes?.HEATERSTATE||"",p=i.attributes?.outside_temperature,h=i.attributes?.min_outside_temperature||14.5,g=d.includes("BLOCKED_BY_OUTSIDE_TEMP")||void 0!==p&&p<h,m=void 0!==r?x.getTemperatureColor(r):void 0,u=[{icon:"mdi:power-off",label:"OFF",action:async()=>{const t=new v(this.hass);await t.setHvacMode(e.entity,"off")},active:"off"===a,color:"#757575"},{icon:"mdi:autorenew",label:"AUTO",action:async()=>{const t=new v(this.hass);await t.setHvacMode(e.entity,"auto")},active:"auto"===a,color:"#2196F3"},{icon:"mdi:fire",label:"HEAT",action:async()=>{const t=new v(this.hass);await t.setHvacMode(e.entity,"heat")},active:"heat"===a||"heating"===a,color:"#FF5722"}],b="heating"===a||"heat"===a,y=void 0!==r?this._getValuePercent(r,c,l):void 0,w=void 0!==n?this._getValuePercent(n,c,l):void 0;return t` <ha-card class="${this._getCardClasses(b,e)}" style="--card-accent: ${o}" @click="${()=>this._showMoreInfo(e.entity)}" ><div class="accent-bar"></div><div class="card-content"><div class="header"><div class="header-icon ${b?"icon-active":""}" style="--icon-accent: ${o}"><ha-icon icon="${e.icon||"mdi:radiator"}" class="${b?"heater-active":""}" ></ha-icon></div><div class="header-info"><span class="name">${s}</span><span class="header-subtitle">${this._getFriendlyState(a)}</span></div> ${e.show_state?t`<status-badge .state="${a}"></status-badge>`:""}
          </div>

          ${void 0!==r?t` <div class="temp-hero" style="--temp-color: ${m?.color||"var(--vpc-primary)"}"><div class="temp-hero-main"><span class="temp-hero-value">${r.toFixed(1)}</span><span class="temp-hero-unit">°C</span></div> ${void 0!==n?t`
                        <div class="temp-hero-target-pill">
                          <ha-icon icon="mdi:target" style="--mdc-icon-size: 13px"></ha-icon>
                          <span>${n.toFixed(1)}°C</span>
                        </div>
                      `:""}
                </div>
                ${void 0!==y?t` <div class="temp-range-bar"><div class="temp-range-track"><div class="temp-range-fill" style="width: ${y}%; background: ${m?.color||o}"></div> ${void 0!==w?t`<div class="temp-range-target" style="left: ${w}%"></div>`:""}
                        </div>
                        <div class="temp-range-labels">
                          <span>${c}°C</span>
                          <span>${l}°C</span>
                        </div>
                      </div>
                    `:""}
              `:""}

          ${e.show_detail_status&&d?t`<detail-status .raw="${d}"></detail-status>`:""}

          ${void 0!==p?t` <div class="info-row ${g?"info-row-warning":""}"><ha-icon icon="mdi:thermometer"></ha-icon><span class="info-label">Outside</span><span class="info-value">${p.toFixed(1)}°C</span> ${g?t`<span class="info-badge warning">Min ${h}°C</span>`:""}
                </div>
              `:""}

          ${e.show_controls?t` ${void 0!==n?t`
                      <slider-control
                        label="Target Temperature"
                        .min="${c}"
                        .max="${l}"
                        step="0.5"
                        .value="${n}"
                        unit="°C"
                        showMinMax
                        @value-changed="${t=>this._handleTemperatureChange(t,e.entity)}"
                      ></slider-control>
                    `:""}
                <quick-actions .actions="${u}"></quick-actions>
              `:""}
        </div>
      </ha-card>
    `}async _handleTemperatureChange(e,t){const i=e.detail.value,a=new v(this.hass);await a.setTemperature(t,i)}renderSolarCard(e=this.config){const i=this.hass.states[e.entity],a=i.state,s=e.name||i.attributes.friendly_name||"Solar",o=this._getAccentColor("solar",e),r=f.getCurrentTemperature(i),n=f.getTargetTemperature(i),c=f.getMinTemperature(i)||18,l=f.getMaxTemperature(i)||32,d=i.attributes?.absorber_temperature,p=void 0!==d&&void 0!==r?d-r:void 0,h=i.attributes?.SOLARSTATE||"",g=[{icon:"mdi:power-off",label:"OFF",action:async()=>{const t=new v(this.hass);await t.setHvacMode(e.entity,"off")},active:"off"===a,color:"#757575"},{icon:"mdi:autorenew",label:"AUTO",action:async()=>{const t=new v(this.hass);await t.setHvacMode(e.entity,"auto")},active:"auto"===a,color:"#2196F3"},{icon:"mdi:sun-thermometer",label:"ON",action:async()=>{const t=new v(this.hass);await t.setHvacMode(e.entity,"heat")},active:"heat"===a||"heating"===a,color:"#FF9800"}],m="heating"===a||"heat"===a,u=void 0!==r?this._getValuePercent(r,c,l):void 0,x=void 0!==n?this._getValuePercent(n,c,l):void 0;return t` <ha-card class="${this._getCardClasses(m,e)}" style="--card-accent: ${o}" @click="${()=>this._showMoreInfo(e.entity)}" ><div class="accent-bar"></div><div class="card-content"><div class="header"><div class="header-icon ${m?"icon-active":""}" style="--icon-accent: ${o}"><ha-icon icon="${e.icon||"mdi:solar-power"}" class="${m?"solar-active":""}" ></ha-icon></div><div class="header-info"><span class="name">${s}</span><span class="header-subtitle">${this._getFriendlyState(a)}</span></div> ${e.show_state?t`<status-badge .state="${a}"></status-badge>`:""}
          </div>

          ${e.show_detail_status&&h?t`<detail-status .raw="${h}"></detail-status>`:""}

          <div class="solar-temps">
            <!-- Solar temperature comparison: pool vs absorber -->
            <div class="solar-temp-comparison">
              ${void 0!==r?t` <div class="solar-temp-tile"><ha-icon icon="mdi:pool" style="--mdc-icon-size: 18px"></ha-icon><div class="solar-temp-tile-val">${r.toFixed(1)}°C</div><div class="solar-temp-tile-label">Pool</div></div> `:""}
              ${void 0!==p?t` <div class="solar-delta-badge ${p>=3?"delta-great":p>0?"delta-ok":"delta-low"}"><ha-icon icon="${p>=0?"mdi:trending-up":"mdi:trending-down"}" style="--mdc-icon-size: 16px"></ha-icon><span>${p>0?"+":""}${p.toFixed(1)}°C</span></div> `:""}
              ${void 0!==d?t` <div class="solar-temp-tile"><ha-icon icon="mdi:solar-panel" style="--mdc-icon-size: 18px"></ha-icon><div class="solar-temp-tile-val">${d.toFixed(1)}°C</div><div class="solar-temp-tile-label">Absorber</div></div> `:""}
            </div>
            ${void 0!==u?t` <div class="temp-range-bar"><div class="temp-range-track"><div class="temp-range-fill" style="width: ${u}%; background: ${o}"></div> ${void 0!==x?t`<div class="temp-range-target" style="left: ${x}%"></div>`:""}
                    </div>
                    <div class="temp-range-labels">
                      <span>${c}°C</span>
                      <span>${l}°C</span>
                    </div>
                  </div>
                `:""}
            ${void 0!==p?t` <div class="delta-hint-text"> ${p<0?"❄ Too cold for solar heating":p<3?"⚡ Solar heating possible":"☀ Ideal conditions for solar heating"} </div> `:""}
          </div>

          ${e.show_controls?t` ${void 0!==n?t`
                      <slider-control
                        label="Target Temperature"
                        .min="${c}"
                        .max="${l}"
                        step="0.5"
                        .value="${n}"
                        unit="°C"
                        showMinMax
                        @value-changed="${t=>this._handleTemperatureChange(t,e.entity)}"
                      ></slider-control>
                    `:""}
                <quick-actions .actions="${g}"></quick-actions>
              `:""}
        </div>
      </ha-card>
    `}renderDosingCard(e=this.config){const i=this.hass.states[e.entity],a=i.state,s=e.name||i.attributes.friendly_name||"Dosing",o=this._getAccentColor("dosing",e),r=e.dosing_type||this._detectDosingType(e.entity),n=Object.keys(i.attributes||{}).find(e=>e.includes("DOS_")&&e.includes("_STATE")),c=n?i.attributes[n]:[];let l,d,p,h,g="";if("chlorine"===r){const e=this._getEntityId("orp_value_entity","sensor","orp_value"),t=this.hass.states[e];l=t?parseFloat(t.state):void 0;const i=this._getEntityId("target_orp_entity","number","target_orp"),a=this.hass.states[i];d=a?parseFloat(a.state):void 0,p=a?.attributes?.min||600,h=a?.attributes?.max||800,g="mV"}else if("ph_minus"===r||"ph_plus"===r){const e=this._getEntityId("ph_value_entity","sensor","ph_value"),t=this.hass.states[e];l=t?parseFloat(t.state):void 0;const i=this._getEntityId("target_ph_entity","number","target_ph"),a=this.hass.states[i];d=a?parseFloat(a.state):void 0,p=a?.attributes?.min||6.8,h=a?.attributes?.max||7.8,g=""}const m=i.attributes?.dosing_volume_24h,u=[{icon:"mdi:power-off",label:"OFF",action:async()=>{const t=new v(this.hass);await t.turnOff(e.entity)},active:"off"===a,color:"#757575"},{icon:"mdi:autorenew",label:"AUTO",action:async()=>{const t=new v(this.hass);await t.turnOn(e.entity)},active:"on"===a||"auto"===a,color:"#2196F3"},{icon:"mdi:play-circle",label:"Dose 30s",action:async()=>{const t=new v(this.hass);await t.manualDosing(e.entity,30)},color:"#4CAF50",confirmMessage:"Start manual dosing for 30 seconds?"},{icon:"mdi:play-speed",label:"Dose 60s",action:async()=>{const t=new v(this.hass);await t.manualDosing(e.entity,60)},color:"#FF9800",confirmMessage:"Start manual dosing for 60 seconds?"}],f="on"===a&&Array.isArray(c)&&c.some(e=>e.includes("ACTIVE")),b=void 0!==l?"chlorine"===r?x.getOrpColor(l,d):x.getPhColor(l,d):void 0,y=void 0!==l&&void 0!==p&&void 0!==h?this._getValuePercent(l,p,h):void 0,w=void 0!==d&&void 0!==p&&void 0!==h?this._getValuePercent(d,p,h):void 0,_="chlorine"===r?0:1,$="chlorine"===r?"ORP":"ph_minus"===r||"ph_plus"===r?"pH":"Floc",k=b?"chlorine"===r?l<(d??650)?"Low":l>(d??750)?"High":"Optimal":l<7?"Acidic":l>7.4?"Alkaline":"Optimal":"";return t` <ha-card class="${this._getCardClasses(f,e)}" style="--card-accent: ${o}" @click="${()=>this._showMoreInfo(e.entity)}" ><div class="accent-bar"></div><div class="card-content"><div class="header"><div class="header-icon ${f?"icon-active":""}" style="--icon-accent: ${o}"><ha-icon icon="${e.icon||this._getDosingIcon(r)}" class="${f?"dosing-active":""}" ></ha-icon></div><div class="header-info"><span class="name">${s}</span><span class="header-subtitle">${this._getFriendlyState(a)}</span></div> ${e.show_state?t`<status-badge .state="${a}" .pulse="${f}"></status-badge>`:""}
          </div>

          ${void 0!==l?t` <!-- Dosing value hero with progress bar --><div class="dosing-value-block"><div class="dosing-value-row"><div class="dosing-value-main" style="color: ${b?.color||"var(--vpc-text)"}"><span class="dosing-label-tag">${$}</span><span class="dosing-current-value">${l.toFixed(_)}</span><span class="dosing-current-unit">${g}</span></div><div class="dosing-status-pill" style="background: ${b?.color?b.color+"18":"rgba(0,0,0,0.05)"}; color: ${b?.color||"var(--vpc-text-secondary)"}"> ${k} </div></div> ${void 0!==y?t`
                        <div class="chem-range-bar">
                          <div class="chem-range-track">
                            <div class="chem-range-fill" style="width: ${y}%; background: ${b?.color||o}"></div>
                            ${void 0!==w?t` <div class="chem-range-target" style="left: ${w}%"><div class="chem-target-line"></div><div class="chem-target-label">${d.toFixed(_)}${g}</div></div> `:""}
                          </div>
                          <div class="chem-range-labels">
                            <span>${p.toFixed(_)}${g}</span>
                            <span>${h.toFixed(_)}${g}</span>
                          </div>
                        </div>
                      `:""}
                </div>
              `:""}

          ${e.show_detail_status&&Array.isArray(c)&&c.length>0?t`<warning-chips .warnings="${c}" defaultType="warning"></warning-chips>`:""}

          ${e.show_controls?t`<quick-actions .actions="${u}"></quick-actions>`:""}

          ${e.show_history&&void 0!==m?t` <div class="info-row"><ha-icon icon="mdi:chart-line"></ha-icon><span class="info-label">Last 24h</span><span class="info-value">${m}ml</span></div> `:""}
        </div>
      </ha-card>
    `}_detectDosingType(e){return e.includes("_cl")?"chlorine":e.includes("_phm")?"ph_minus":e.includes("_php")?"ph_plus":e.includes("_floc")?"flocculant":"chlorine"}_getDosingIcon(e){switch(e){case"chlorine":default:return"mdi:flask-outline";case"ph_minus":return"mdi:flask-minus";case"ph_plus":return"mdi:flask-plus";case"flocculant":return"mdi:flask"}}renderOverviewCard(e=this.config){const i=e.name||"Pool Status",a=this._getAccentColor("overview",e),s=this._getEntityId("pump_entity","switch","pump",0),o=this._getEntityId("heater_entity","climate","heater",1),r=this._getEntityId("solar_entity","climate","solar",2),n=this._getEntityId("chlorine_entity","switch","dos_1_cl",3),c=this._getEntityId("ph_minus_entity","switch","dos_2_phm",4),l=this.hass.states[s],d=this.hass.states[o],p=this.hass.states[r],h=this.hass.states[n],g=this.hass.states[c],m=this._getEntityId("pool_temp_entity","sensor","temperature",5),u=this._getEntityId("ph_value_entity","sensor","ph_value",6),v=this._getEntityId("orp_value_entity","sensor","orp_value",7),b=this.hass.states[m],y=this.hass.states[u],w=this.hass.states[v],_=b?parseFloat(b.state):void 0,$=y?parseFloat(y.state):void 0,k=w?parseFloat(w.state):void 0,C=void 0!==_?x.getTemperatureColor(_):void 0,F=void 0!==$?x.getPhColor($):void 0,z=void 0!==k?x.getOrpColor(k):void 0,S=void 0===(A=$)||isNaN(A)?"unknown":A<7||A>7.4?"warning":"ok";var A;const T=void 0===(E=k)||isNaN(E)?"unknown":E<650?"warning":E>750?"high":"ok";var E;const P=[];if(l){const e=f.parsePumpState(l.attributes?.PUMPSTATE||"");P.push({icon:"mdi:pump",name:"Pump",status:e.status||l.state,state:l.state,entityId:s})}if(d){const e=f.parseHeaterState(d.attributes?.HEATERSTATE||"");P.push({icon:"mdi:radiator",name:"Heater",status:e.status||d.state,state:d.state,entityId:o})}if(p){const e=f.parseSolarState(p.attributes?.SOLARSTATE||"");P.push({icon:"mdi:solar-power",name:"Solar",status:e.status||p.state,state:p.state,entityId:r})}if(h){const e=h.attributes?.DOS_1_CL_STATE||[],t=Array.isArray(e)&&e.length>0?f.formatSnakeCase(e[0]):h.state;P.push({icon:"mdi:flask-outline",name:"Chlorine",status:t,state:h.state,entityId:n})}if(g){const e=g.attributes?.DOS_2_PHM_STATE||[],t=Array.isArray(e)&&e.length>0?f.formatSnakeCase(e[0]):g.state;P.push({icon:"mdi:flask-minus",name:"pH-",status:t,state:g.state,entityId:c})}const D=[];if("warning"===T&&D.push("ORP too low - Check chlorine dosing"),"high"===T&&D.push("ORP too high - Stop chlorine dosing"),"warning"===S&&D.push("pH out of range - Check dosing"),l?.attributes?.PUMPSTATE?.includes("ANTI_FREEZE")){const e=d?.attributes?.outside_temperature;D.push("Frost protection active"+(e?` (${e.toFixed(1)}°C)`:""))}const M=P.some(e=>["on","auto","heat","heating"].includes(e.state)),O=P.filter(e=>["on","auto","heat","heating"].includes(e.state)).length,I=void 0!==_?this._getValuePercent(_,18,35):void 0,V=void 0!==$?this._getValuePercent($,6.5,8):void 0,H=void 0!==k?this._getValuePercent(k,500,900):void 0,N=this._getValuePercent(7,6.5,8),B=this._getValuePercent(7.4,6.5,8),R=this._getValuePercent(650,500,900),q=this._getValuePercent(750,500,900);return t` <ha-card class="${this._getCardClasses(M,e)}" style="--card-accent: ${a}" ><div class="accent-bar"></div><div class="card-content"><!-- Header --><div class="header"><div class="header-icon ${M?"icon-active":""}" style="--icon-accent: ${a}"><ha-icon icon="mdi:pool"></ha-icon></div><div class="header-info"><span class="name">${i}</span><span class="header-subtitle"> ${M?`${O} device${1!==O?"s":""} active`:"All systems idle"}
              </span>
            </div>
            ${D.length>0?t`<div class="overview-warning-badge">${D.length}</div>`:M?t`<div class="overview-active-dot"></div>`:""}
          </div>

          <!-- Water Chemistry - Apple Health style metric tiles -->
          <div class="chemistry-grid">
            ${void 0!==_?t` <div class="chemistry-card" style="--chem-color: ${C?.color||"#4CAF50"}" @click="${e=>{e.stopPropagation(),this._showMoreInfo(m)}}"><div class="chem-icon-wrap"><ha-icon icon="mdi:thermometer-water"></ha-icon></div><span class="chemistry-val">${_.toFixed(1)}°</span><span class="chemistry-unit">°C</span><span class="chemistry-label">Temp</span> ${void 0!==I?t`<div class="chem-mini-bar"><div class="chem-mini-fill" style="width: ${I}%; background: ${C?.color||"#4CAF50"}"></div></div>`:""}
                  </div>
                `:""}
            ${void 0!==$?t` <div class="chemistry-card" style="--chem-color: ${F?.color||"#4CAF50"}" @click="${e=>{e.stopPropagation(),this._showMoreInfo(u)}}"><div class="chem-icon-wrap"><ha-icon icon="mdi:ph"></ha-icon></div><span class="chemistry-val">${$.toFixed(1)}</span><span class="chemistry-unit">pH</span><span class="chemistry-label">${"ok"===S?"Optimal":"Attention"}</span> ${void 0!==V?t`
                          <div class="chem-mini-bar">
                            <div class="chem-mini-ideal" style="left: ${N}%; width: ${B-N}%"></div>
                            <div class="chem-mini-fill" style="width: ${V}%; background: ${F?.color||"#4CAF50"}"></div>
                          </div>
                        `:""}
                  </div>
                `:""}
            ${void 0!==k?t` <div class="chemistry-card" style="--chem-color: ${z?.color||"#4CAF50"}" @click="${e=>{e.stopPropagation(),this._showMoreInfo(v)}}"><div class="chem-icon-wrap"><ha-icon icon="mdi:lightning-bolt"></ha-icon></div><span class="chemistry-val">${k.toFixed(0)}</span><span class="chemistry-unit">mV</span><span class="chemistry-label">${"ok"===T?"Optimal":"warning"===T?"Low":"High"}</span> ${void 0!==H?t`
                          <div class="chem-mini-bar">
                            <div class="chem-mini-ideal" style="left: ${R}%; width: ${q-R}%"></div>
                            <div class="chem-mini-fill" style="width: ${H}%; background: ${z?.color||"#4CAF50"}"></div>
                          </div>
                        `:""}
                  </div>
                `:""}
          </div>

          <!-- Device List - clean rows -->
          ${P.length>0?t` <div class="overview-section"><div class="section-title"><span>Devices</span><span class="section-count">${P.length}</span></div><div class="device-list"> ${P.map(e=>t`
                        <div class="device-row"
                          @click="${t=>{t.stopPropagation(),this._showMoreInfo(e.entityId)}}">
                          <div class="device-icon-wrap ${["on","auto","heat","heating"].includes(e.state)?"device-icon-active":""}">
                            <ha-icon icon="${e.icon}"></ha-icon>
                          </div>
                          <div class="device-info">
                            <span class="device-name">${e.name}</span>
                            <span class="device-status">${e.status}</span>
                          </div>
                          <div class="device-dot ${["on","auto","heat","heating"].includes(e.state)?"dot-active":"dot-inactive"}"></div>
                        </div>
                      `)}
                  </div>
                </div>
              `:""}

          <!-- Warnings / All OK -->
          ${D.length>0?t` <div class="overview-section"><div class="section-title warning-title"><ha-icon icon="mdi:alert-outline" style="--mdc-icon-size: 14px"></ha-icon><span>Alerts</span></div><div class="warning-list"> ${D.map(e=>t`
                        <div class="warning-row">
                          <ha-icon icon="${e.includes("Frost")?"mdi:snowflake-alert":"mdi:alert-circle"}" style="--mdc-icon-size: 16px"></ha-icon>
                          <span>${e}</span>
                        </div>
                      `)}
                  </div>
                </div>
              `:t` <div class="all-ok-display"><ha-icon icon="mdi:check-circle" style="--mdc-icon-size: 18px"></ha-icon><span>All systems normal</span></div> `}
        </div>
      </ha-card>
    `}renderCompactCard(e=this.config){const i=this.hass.states[e.entity],a=i.state,s=e.name||i.attributes.friendly_name||"Entity",o=e.entity.split(".")[0];let r=e.icon;r||(r="switch"===o&&e.entity.includes("pump")?"mdi:pump":"climate"===o&&e.entity.includes("heater")?"mdi:radiator":"climate"===o&&e.entity.includes("solar")?"mdi:solar-power":"switch"===o&&e.entity.includes("dos")?"mdi:flask-outline":"mdi:circle");let n="",c="";if(i.attributes?.PUMPSTATE){const e=f.parsePumpState(i.attributes.PUMPSTATE);n=e.status,void 0!==e.level&&e.level>0&&(c="Level "+e.level)}else if(i.attributes?.HEATERSTATE){n=f.parseHeaterState(i.attributes.HEATERSTATE).status;const e=f.getCurrentTemperature(i);void 0!==e&&(c=e.toFixed(1)+"°C")}else if(i.attributes?.SOLARSTATE){n=f.parseSolarState(i.attributes.SOLARSTATE).status;const e=f.getCurrentTemperature(i);void 0!==e&&(c=e.toFixed(1)+"°C")}else if(Object.keys(i.attributes||{}).some(e=>e.includes("DOS_")&&e.includes("_STATE"))){const t=Object.keys(i.attributes||{}).find(e=>e.includes("DOS_")&&e.includes("_STATE")),a=t?i.attributes[t]:[];Array.isArray(a)&&a.length>0&&(n=f.formatSnakeCase(a[0]));const s=this._detectDosingType(e.entity);if("chlorine"===s){const e=this._getEntityId("orp_value_entity","sensor","orp_value"),t=this.hass.states[e];t&&(c=parseFloat(t.state).toFixed(0)+"mV")}else if("ph_minus"===s||"ph_plus"===s){const e=this._getEntityId("ph_value_entity","sensor","ph_value"),t=this.hass.states[e];t&&(c="pH "+parseFloat(t.state).toFixed(1))}}const l="on"===a||"auto"===a||"heat"===a||"heating"===a;return t` <ha-card class="compact-card ${this._getCardClasses(l,e)}" @click="${()=>this._showMoreInfo(e.entity)}" ><div class="card-content compact"><div class="compact-icon ${l?"compact-icon-active":""}"><ha-icon icon="${r}" class="${l?"active":"inactive"}" ></ha-icon></div><div class="compact-info"><span class="name">${s}</span><div class="compact-details"> ${c?t`<span class="compact-value">${c}</span>`:""}
              ${n?t`<span class="compact-detail">${n}</span>`:""}
            </div>
          </div>
          <status-badge .state="${a}"></status-badge>
        </div>
      </ha-card>
    `}static get styles(){return i`:host{--vpc-font:-apple-system, 'SF Pro Display', 'SF Pro Text', system-ui, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;--vpc-spacing:18px;--vpc-radius:20px;--vpc-inner-radius:12px;--vpc-bg:var(--ha-card-background, var(--card-background-color, #ffffff));--vpc-surface:rgba(120,120,128,0.06);--vpc-border:none;--vpc-shadow:0 2px 20px rgba(0,0,0,0.07), 0 1px 3px rgba(0,0,0,0.04);--vpc-backdrop:none;--vpc-primary:var(--primary-color, #007AFF);--vpc-success:#34C759;--vpc-warning:#FF9F0A;--vpc-danger:#FF3B30;--vpc-purple:#AF52DE;--vpc-teal:#5AC8FA;--vpc-orange:#FF9500;--vpc-indigo:#5856D6;--vpc-text:var(--primary-text-color, #1C1C1E);--vpc-text-secondary:var(--secondary-text-color, #6D6D72);--vpc-text-tertiary:rgba(60,60,67,0.45);--vpc-icon-size:22px;--vpc-transition:all 0.28s cubic-bezier(0.34, 1.4, 0.64, 1);--vpc-transition-fast:all 0.18s ease;--card-accent:var(--primary-color, #007AFF);--icon-accent:var(--card-accent);display:block;font-family:var(--vpc-font);}ha-card.theme-apple{--vpc-bg:#ffffff;--vpc-shadow:0 2px 20px rgba(0,0,0,0.08), 0 1px 3px rgba(0,0,0,0.04);--vpc-radius:22px;--vpc-inner-radius:13px;--vpc-surface:rgba(120,120,128,0.06);--vpc-primary:#007AFF;}ha-card.theme-dark{--vpc-bg:#1C1C1E;--vpc-surface:rgba(255,255,255,0.06);--vpc-border:1px solid rgba(255,255,255,0.08);--vpc-shadow:0 4px 30px rgba(0,0,0,0.4);--vpc-radius:22px;--vpc-text:#FFFFFF;--vpc-text-secondary:#8E8E93;--vpc-text-tertiary:rgba(255,255,255,0.25);--vpc-primary:#0A84FF;--vpc-success:#30D158;--vpc-warning:#FFD60A;--vpc-danger:#FF453A;}ha-card.theme-luxury, ha-card.theme-glass{--vpc-bg:rgba(255,255,255,0.72);--vpc-backdrop:blur(24px) saturate(180%);--vpc-radius:26px;--vpc-border:1px solid rgba(255,255,255,0.4);--vpc-shadow:0 8px 40px rgba(31,38,135,0.12), 0 2px 8px rgba(0,0,0,0.06);}ha-card.theme-modern{--vpc-radius:18px;--vpc-spacing:20px;--vpc-shadow:0 1px 3px rgba(0,0,0,0.05), 0 0 0 1px rgba(0,0,0,0.04);}ha-card.theme-minimalist{--vpc-radius:14px;--vpc-shadow:none;--vpc-border:1px solid rgba(0,0,0,0.07);--vpc-surface:transparent;}ha-card.theme-neon{--vpc-bg:#0D0D14;--vpc-border:1px solid rgba(0,212,255,0.2);--vpc-shadow:0 0 30px rgba(0,212,255,0.07);--vpc-radius:14px;--vpc-primary:#00D4FF;--vpc-text:#E8E8F0;--vpc-text-secondary:#6E6E80;--vpc-surface:rgba(0,212,255,0.04);--vpc-success:#00E676;--vpc-warning:#FFEA00;--vpc-danger:#FF1744;}ha-card.theme-premium{--vpc-bg:linear-gradient(145deg, rgba(255,255,255,0.96) 0%, rgba(248,248,255,0.96) 100%);--vpc-radius:24px;--vpc-shadow:0 12px 50px -8px rgba(80,80,160,0.15), 0 0 0 1px rgba(255,255,255,0.9);--vpc-border:1px solid rgba(255,255,255,0.7);}@media (prefers-color-scheme:dark){ha-card.theme-apple{--vpc-bg:#1C1C1E;--vpc-surface:rgba(255,255,255,0.06);--vpc-border:1px solid rgba(255,255,255,0.08);--vpc-text:#FFFFFF;--vpc-text-secondary:#8E8E93;--vpc-primary:#0A84FF;--vpc-success:#30D158;--vpc-warning:#FFD60A;--vpc-danger:#FF453A;}ha-card.theme-luxury, ha-card.theme-glass{--vpc-bg:rgba(18,18,30,0.80);--vpc-border:1px solid rgba(255,255,255,0.09);--vpc-shadow:0 8px 40px rgba(0,0,0,0.45);}ha-card.theme-premium{--vpc-bg:linear-gradient(145deg, rgba(28,28,38,0.97) 0%, rgba(20,20,32,0.97) 100%);--vpc-border:1px solid rgba(255,255,255,0.07);}ha-card.theme-minimalist{--vpc-border:1px solid rgba(255,255,255,0.07);}ha-card.theme-modern{--vpc-shadow:0 1px 3px rgba(0,0,0,0.2), 0 0 0 1px rgba(255,255,255,0.04);}}ha-card{font-family:var(--vpc-font);padding:var(--vpc-spacing);background:var(--vpc-bg);border-radius:var(--vpc-radius);box-shadow:var(--vpc-shadow);border:var(--vpc-border);backdrop-filter:var(--vpc-backdrop);-webkit-backdrop-filter:var(--vpc-backdrop);transition:transform 0.22s cubic-bezier(0.34,1.4,0.64,1), box-shadow 0.22s ease;overflow:hidden;position:relative;cursor:pointer;-webkit-tap-highlight-color:transparent;user-select:none;}ha-card:hover{transform:translateY(-2px);box-shadow:0 8px 30px rgba(0,0,0,0.11), 0 2px 6px rgba(0,0,0,0.05);}ha-card:active{transform:scale(0.985);box-shadow:0 2px 8px rgba(0,0,0,0.07);transition:transform 0.1s ease, box-shadow 0.1s ease;}ha-card.theme-dark:hover{box-shadow:0 8px 30px rgba(0,0,0,0.5);}ha-card.theme-neon:hover{box-shadow:0 0 40px rgba(0,212,255,0.12), 0 4px 20px rgba(0,0,0,0.3);}ha-card.theme-neon.is-active{box-shadow:0 0 50px rgba(0,212,255,0.2), inset 0 0 20px rgba(0,212,255,0.04);border-color:rgba(0,212,255,0.35);}.accent-bar{position:absolute;top:0;left:0;right:0;height:3px;background:var(--card-accent);opacity:0.65;transition:opacity 0.3s ease, height 0.3s ease;}ha-card.is-active .accent-bar{height:4px;opacity:1;}ha-card.theme-neon .accent-bar{background:linear-gradient(90deg, #00D4FF, #7C4DFF, #00D4FF);box-shadow:0 0 12px rgba(0,212,255,0.5);height:2px;animation:neon-flow 3s linear infinite;}ha-card.theme-minimalist .accent-bar{height:2px;opacity:0.45;}@keyframes neon-flow{0%{background-position:0% 50%;}100%{background-position:200% 50%;}}.card-content{display:flex;flex-direction:column;gap:14px;}.card-content.compact{flex-direction:row;align-items:center;gap:14px;}.header{display:flex;align-items:center;gap:14px;}.header-icon{width:46px;height:46px;border-radius:15px;display:flex;align-items:center;justify-content:center;background:color-mix(in srgb, var(--icon-accent, var(--vpc-primary)) 12%, transparent);transition:background 0.25s ease, box-shadow 0.25s ease;flex-shrink:0;}.header-icon.icon-active{background:color-mix(in srgb, var(--icon-accent, var(--vpc-primary)) 18%, transparent);box-shadow:0 0 0 5px color-mix(in srgb, var(--icon-accent, var(--vpc-primary)) 8%, transparent);}ha-card.theme-neon .header-icon{background:rgba(0,212,255,0.08);border:1px solid rgba(0,212,255,0.18);}ha-card.theme-neon .header-icon.icon-active{box-shadow:0 0 16px rgba(0,212,255,0.25);}.header-icon ha-icon{--mdc-icon-size:24px;color:var(--icon-accent, var(--vpc-primary));}.header-info{flex:1;min-width:0;display:flex;flex-direction:column;gap:2px;}.name{font-family:var(--vpc-font);font-size:16px;font-weight:600;letter-spacing:-0.3px;color:var(--vpc-text);line-height:1.25;}.header-subtitle{font-family:var(--vpc-font);font-size:13px;font-weight:400;color:var(--vpc-text-secondary);line-height:1.2;}ha-icon{--mdc-icon-size:var(--vpc-icon-size);color:var(--vpc-primary);transition:color 0.2s ease;}@keyframes rotate{from{transform:rotate(0deg);}to{transform:rotate(360deg);}}@keyframes pulse-glow{0%, 100%{opacity:1;transform:scale(1);}50%{opacity:0.65;transform:scale(0.95);}}@keyframes breathe{0%, 100%{transform:scale(1);opacity:1;}50%{transform:scale(1.08);opacity:0.85;}}@keyframes spin-slow{from{transform:rotate(0deg);}to{transform:rotate(360deg);}}.pump-running{animation:rotate 1.8s linear infinite;}.heater-active{animation:breathe 2.5s ease-in-out infinite;color:var(--vpc-danger, #FF3B30);}.solar-active{animation:breathe 3s ease-in-out infinite;color:var(--vpc-warning, #FF9F0A);}.dosing-active{animation:pulse-glow 2s ease-in-out infinite;color:var(--vpc-success, #34C759);}.speed-segments-container{display:flex;align-items:center;gap:8px;}.speed-segments{display:flex;flex:1;gap:6px;}.speed-segment{flex:1;display:flex;align-items:center;justify-content:center;gap:4px;padding:9px 6px;border-radius:var(--vpc-inner-radius, 12px);border:none;background:var(--vpc-surface, rgba(120,120,128,0.06));color:var(--vpc-text-secondary);font-family:var(--vpc-font);font-size:12px;font-weight:500;cursor:pointer;transition:all 0.18s ease;-webkit-tap-highlight-color:transparent;letter-spacing:-0.2px;}.speed-segment:hover{background:color-mix(in srgb, var(--seg-color) 10%, transparent);color:var(--seg-color);}.speed-segment.seg-active{background:color-mix(in srgb, var(--seg-color) 15%, transparent);color:var(--seg-color);font-weight:600;box-shadow:inset 0 0 0 1.5px color-mix(in srgb, var(--seg-color) 40%, transparent);}.speed-segment.seg-past{background:color-mix(in srgb, var(--seg-color) 08%, transparent);color:color-mix(in srgb, var(--seg-color) 70%, var(--vpc-text-secondary));}.speed-off-btn{width:38px;height:38px;border-radius:12px;border:none;background:var(--vpc-surface);color:var(--vpc-text-secondary);display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all 0.18s ease;flex-shrink:0;-webkit-tap-highlight-color:transparent;}.speed-off-btn:hover{background:rgba(255,59,48,0.1);color:var(--vpc-danger, #FF3B30);}.speed-off-btn.seg-active{background:rgba(255,59,48,0.12);color:var(--vpc-danger, #FF3B30);box-shadow:inset 0 0 0 1.5px rgba(255,59,48,0.3);}ha-card.theme-neon .speed-segment{border:1px solid rgba(0,212,255,0.1);}ha-card.theme-neon .speed-segment.seg-active{box-shadow:0 0 12px color-mix(in srgb, var(--seg-color) 50%, transparent);}.temp-hero{display:flex;align-items:center;gap:12px;padding:6px 0 4px;}.temp-hero-main{display:flex;align-items:baseline;gap:4px;}.temp-hero-value{font-family:var(--vpc-font);font-size:44px;font-weight:700;line-height:1;letter-spacing:-2px;color:var(--temp-color, var(--vpc-text));}.temp-hero-unit{font-size:22px;font-weight:400;color:var(--temp-color, var(--vpc-text));opacity:0.65;letter-spacing:-0.5px;}.temp-hero-target-pill{display:inline-flex;align-items:center;gap:4px;padding:4px 10px;border-radius:100px;background:var(--vpc-surface);font-size:13px;font-weight:500;color:var(--vpc-text-secondary);white-space:nowrap;}.temp-range-bar, .chem-range-bar{display:flex;flex-direction:column;gap:5px;}.temp-range-track, .chem-range-track{height:6px;background:var(--vpc-surface);border-radius:100px;position:relative;overflow:visible;}.temp-range-fill, .chem-range-fill{height:100%;border-radius:100px;transition:width 0.5s cubic-bezier(0.34,1.4,0.64,1);}.temp-range-target{position:absolute;top:50%;transform:translate(-50%, -50%);width:3px;height:14px;background:var(--vpc-text-secondary);border-radius:2px;opacity:0.7;}.temp-range-labels, .chem-range-labels{display:flex;justify-content:space-between;font-size:11px;font-weight:400;color:var(--vpc-text-tertiary, rgba(60,60,67,0.45));letter-spacing:0px;}.dosing-value-block{display:flex;flex-direction:column;gap:10px;padding:14px;border-radius:var(--vpc-inner-radius, 12px);background:var(--vpc-surface);}ha-card.theme-neon .dosing-value-block{background:rgba(0,212,255,0.04);border:1px solid rgba(0,212,255,0.08);}.dosing-value-row{display:flex;align-items:center;justify-content:space-between;gap:10px;}.dosing-value-main{display:flex;align-items:baseline;gap:6px;}.dosing-label-tag{font-size:12px;font-weight:600;letter-spacing:0.5px;text-transform:uppercase;color:var(--vpc-text-secondary);}.dosing-current-value{font-family:var(--vpc-font);font-size:32px;font-weight:700;line-height:1;letter-spacing:-1px;}.dosing-current-unit{font-size:15px;font-weight:400;opacity:0.65;}.dosing-status-pill{padding:4px 10px;border-radius:100px;font-size:12px;font-weight:600;white-space:nowrap;}.chem-range-target{position:absolute;top:50%;transform:translate(-50%, -50%);display:flex;flex-direction:column;align-items:center;gap:2px;}.chem-target-line{width:2px;height:14px;background:var(--vpc-text);border-radius:2px;opacity:0.5;}.chem-target-label{position:absolute;top:16px;font-size:9px;font-weight:600;color:var(--vpc-text-secondary);white-space:nowrap;transform:translateX(-50%);}.chem-mini-bar{width:100%;height:4px;background:var(--vpc-surface, rgba(120,120,128,0.1));border-radius:100px;overflow:hidden;position:relative;margin-top:4px;}.chem-mini-fill{height:100%;border-radius:100px;transition:width 0.5s cubic-bezier(0.34,1.4,0.64,1);}.chem-mini-ideal{position:absolute;top:0;height:100%;background:rgba(52,199,89,0.18);border-radius:2px;}.solar-temp-comparison{display:flex;align-items:center;justify-content:space-between;gap:8px;padding:12px;background:var(--vpc-surface);border-radius:var(--vpc-inner-radius, 12px);}ha-card.theme-neon .solar-temp-comparison{background:rgba(0,212,255,0.04);border:1px solid rgba(0,212,255,0.08);}.solar-temp-tile{display:flex;flex-direction:column;align-items:center;gap:4px;flex:1;}.solar-temp-tile ha-icon{--mdc-icon-size:18px;color:var(--vpc-text-secondary);}.solar-temp-tile-val{font-size:20px;font-weight:700;letter-spacing:-0.5px;color:var(--vpc-text);line-height:1;}.solar-temp-tile-label{font-size:11px;font-weight:500;color:var(--vpc-text-secondary);text-transform:uppercase;letter-spacing:0.3px;}.solar-delta-badge{display:flex;flex-direction:column;align-items:center;gap:3px;padding:8px 12px;border-radius:100px;font-size:12px;font-weight:700;}.delta-great{background:rgba(52,199,89,0.12);color:var(--vpc-success, #34C759);}.delta-ok{background:rgba(255,159,10,0.12);color:var(--vpc-warning, #FF9F0A);}.delta-low{background:rgba(255,59,48,0.10);color:var(--vpc-danger, #FF3B30);}.delta-hint-text{font-size:12px;font-weight:400;color:var(--vpc-text-secondary);padding:2px 0;}.chemistry-grid{display:grid;grid-template-columns:repeat(3, 1fr);gap:8px;}.chemistry-card{display:flex;flex-direction:column;align-items:center;gap:2px;padding:14px 8px 12px;border-radius:var(--vpc-inner-radius, 12px);background:var(--vpc-surface);cursor:pointer;transition:transform 0.18s ease, background 0.18s ease;position:relative;overflow:hidden;}.chemistry-card::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;background:var(--chem-color, var(--vpc-primary));opacity:0.6;border-radius:100px;}.chemistry-card:hover{transform:scale(1.02);background:color-mix(in srgb, var(--chem-color) 8%, var(--vpc-surface));}ha-card.theme-neon .chemistry-card{background:rgba(0,212,255,0.04);border:1px solid rgba(0,212,255,0.08);}.chem-icon-wrap{width:30px;height:30px;border-radius:8px;display:flex;align-items:center;justify-content:center;background:color-mix(in srgb, var(--chem-color, var(--vpc-primary)) 12%, transparent);margin-bottom:4px;}.chem-icon-wrap ha-icon{--mdc-icon-size:16px;color:var(--chem-color, var(--vpc-primary));}.chemistry-val{font-family:var(--vpc-font);font-size:18px;font-weight:700;letter-spacing:-0.5px;color:var(--chem-color, var(--vpc-text));line-height:1;}.chemistry-unit{font-size:11px;font-weight:500;color:var(--vpc-text-secondary);letter-spacing:0.2px;}.chemistry-label{font-size:10px;font-weight:500;color:var(--vpc-text-secondary);text-transform:uppercase;letter-spacing:0.4px;}.overview-warning-badge{width:22px;height:22px;border-radius:50%;background:var(--vpc-danger, #FF3B30);color:#fff;font-size:12px;font-weight:700;display:flex;align-items:center;justify-content:center;flex-shrink:0;}.overview-active-dot{width:10px;height:10px;border-radius:50%;background:var(--vpc-success, #34C759);box-shadow:0 0 8px rgba(52,199,89,0.5);flex-shrink:0;animation:pulse-glow 2s ease-in-out infinite;}.overview-section{display:flex;flex-direction:column;gap:6px;}.section-title{display:flex;align-items:center;gap:6px;font-size:11px;font-weight:600;color:var(--vpc-text-secondary);text-transform:uppercase;letter-spacing:0.6px;padding:0 2px;}.section-count{margin-left:auto;font-size:11px;font-weight:500;color:var(--vpc-text-tertiary);}.warning-title ha-icon{color:var(--vpc-warning, #FF9F0A);}.warning-title{color:var(--vpc-warning, #FF9F0A);}.temp-hero{display:flex;align-items:baseline;gap:4px;padding:8px 0;}.temp-hero-value{font-size:42px;font-weight:800;line-height:1;color:var(--temp-color, var(--vpc-text));letter-spacing:-1px;}.temp-hero-unit{font-size:22px;font-weight:500;color:var(--temp-color, var(--vpc-text));opacity:0.7;}.temp-hero-target{font-size:16px;font-weight:500;color:var(--vpc-text-secondary);margin-left:12px;}.info-row{display:flex;align-items:center;gap:10px;padding:10px 14px;border-radius:var(--vpc-inner-radius, 12px);background:var(--vpc-surface);font-size:14px;color:var(--vpc-text);font-family:var(--vpc-font);}ha-card.theme-neon .info-row{background:rgba(0,212,255,0.04);border:1px solid rgba(0,212,255,0.08);}.info-row ha-icon{--mdc-icon-size:17px;color:var(--vpc-text-secondary);flex-shrink:0;}.info-label{flex:1;font-weight:400;color:var(--vpc-text-secondary);}.info-value{font-weight:600;color:var(--vpc-text);letter-spacing:-0.2px;}.info-badge{padding:3px 9px;border-radius:100px;font-size:11px;font-weight:600;}.info-badge.warning{background:color-mix(in srgb, var(--vpc-warning, #FF9F0A) 12%, transparent);color:var(--vpc-warning, #FF9F0A);}.info-row-warning{background:color-mix(in srgb, var(--vpc-warning, #FF9F0A) 06%, transparent);border:1px solid color-mix(in srgb, var(--vpc-warning, #FF9F0A) 18%, transparent);}.solar-temps{display:flex;flex-direction:column;gap:8px;}.chemistry-grid{display:grid;grid-template-columns:repeat(3, 1fr);gap:10px;}.chemistry-card{display:flex;flex-direction:column;align-items:center;gap:6px;padding:14px 8px;border-radius:14px;background:rgba(var(--rgb-primary-text-color, 0,0,0), 0.03);cursor:pointer;transition:var(--vpc-transition);border:1px solid transparent;}.chemistry-card:hover{background:rgba(var(--rgb-primary-text-color, 0,0,0), 0.06);transform:translateY(-1px);}ha-card.theme-neon .chemistry-card{background:rgba(0, 255, 255, 0.04);border:1px solid rgba(0, 255, 255, 0.08);}.chemistry-card ha-icon{--mdc-icon-size:20px;color:var(--chem-color, var(--vpc-primary));}.chemistry-val{font-size:16px;font-weight:700;color:var(--chem-color, var(--vpc-text));line-height:1;}.chemistry-label{font-size:11px;font-weight:500;color:var(--vpc-text-secondary);text-transform:uppercase;letter-spacing:0.3px;}.overview-section{display:flex;flex-direction:column;gap:8px;}.section-title{display:flex;align-items:center;gap:6px;font-size:12px;font-weight:600;color:var(--vpc-text-secondary);text-transform:uppercase;letter-spacing:0.5px;padding:0 2px;}.section-title ha-icon{--mdc-icon-size:16px;color:var(--vpc-text-secondary);}.warning-title ha-icon{color:#ef6c00;}.warning-title{color:#ef6c00;}.device-list{display:flex;flex-direction:column;gap:3px;}.device-row{display:flex;align-items:center;gap:12px;padding:10px 12px;border-radius:var(--vpc-inner-radius, 12px);background:var(--vpc-surface);cursor:pointer;transition:background 0.18s ease, transform 0.15s ease;}.device-row:hover{background:color-mix(in srgb, var(--vpc-primary) 6%, var(--vpc-surface));transform:scale(1.005);}ha-card.theme-neon .device-row{background:rgba(0,212,255,0.04);border:1px solid rgba(0,212,255,0.06);}.device-icon-wrap{width:32px;height:32px;border-radius:9px;background:var(--vpc-surface);display:flex;align-items:center;justify-content:center;flex-shrink:0;transition:background 0.2s ease;}.device-icon-wrap ha-icon{--mdc-icon-size:18px;color:var(--vpc-text-secondary);}.device-icon-active{background:color-mix(in srgb, var(--vpc-primary) 12%, transparent);}.device-icon-active ha-icon{color:var(--vpc-primary) !important;}.device-info{flex:1;min-width:0;display:flex;flex-direction:column;gap:1px;}.device-name{font-weight:500;font-size:14px;letter-spacing:-0.1px;color:var(--vpc-text);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}.device-status{color:var(--vpc-text-secondary);font-size:12px;font-weight:400;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}.device-dot{width:8px;height:8px;border-radius:50%;flex-shrink:0;}.dot-active{background:var(--vpc-success, #34C759);box-shadow:0 0 6px rgba(52,199,89,0.5);}.dot-inactive{background:var(--vpc-text-secondary);opacity:0.25;}.warning-list{display:flex;flex-direction:column;gap:5px;}.warning-row{display:flex;align-items:center;gap:10px;padding:10px 12px;border-radius:var(--vpc-inner-radius, 12px);background:color-mix(in srgb, var(--vpc-warning, #FF9F0A) 8%, transparent);border:1px solid color-mix(in srgb, var(--vpc-warning, #FF9F0A) 20%, transparent);font-size:13px;font-weight:500;color:var(--vpc-warning, #FF9F0A);}.warning-row ha-icon{color:var(--vpc-warning, #FF9F0A);flex-shrink:0;}.all-ok-display{display:flex;align-items:center;justify-content:center;gap:8px;padding:14px;border-radius:var(--vpc-inner-radius, 12px);background:color-mix(in srgb, var(--vpc-success, #34C759) 8%, transparent);border:1px solid color-mix(in srgb, var(--vpc-success, #34C759) 18%, transparent);color:var(--vpc-success, #34C759);font-weight:500;font-size:14px;}.all-ok-display ha-icon{color:var(--vpc-success, #34C759);}ha-card.compact-card{padding:12px 14px;}.compact-icon{width:40px;height:40px;border-radius:12px;display:flex;align-items:center;justify-content:center;background:var(--vpc-surface);flex-shrink:0;transition:background 0.2s ease;}.compact-icon-active{background:color-mix(in srgb, var(--vpc-primary) 12%, transparent);}.compact-icon ha-icon{--mdc-icon-size:20px;}.compact-icon ha-icon.active{color:var(--vpc-primary);}.compact-icon ha-icon.inactive{color:var(--vpc-text-secondary);opacity:0.45;}.compact-info{flex:1;min-width:0;}.compact-details{display:flex;gap:8px;font-size:12px;margin-top:2px;align-items:center;}.compact-value{font-weight:600;color:var(--vpc-text);letter-spacing:-0.2px;}.compact-detail{color:var(--vpc-text-secondary);font-size:11px;}.system-grid{display:grid;grid-template-columns:repeat(auto-fit, minmax(320px, 1fr));gap:20px;}.error-state{display:flex;align-items:center;gap:14px;padding:20px;}.error-icon{width:44px;height:44px;border-radius:14px;display:flex;align-items:center;justify-content:center;background:rgba(244, 67, 54, 0.1);}.error-icon ha-icon{--mdc-icon-size:24px;color:#d32f2f;}.error-info{display:flex;flex-direction:column;gap:2px;}.error-title{font-size:14px;font-weight:600;color:#d32f2f;}.error-entity{font-size:12px;color:var(--vpc-text-secondary);font-family:monospace;}ha-card.size-small{--vpc-spacing:12px;--vpc-icon-size:20px;--vpc-radius:16px;}ha-card.size-small .header-icon{width:38px;height:38px;border-radius:11px;}ha-card.size-small .name{font-size:14px;}ha-card.size-small .temp-hero-value{font-size:34px;letter-spacing:-1.5px;}ha-card.size-large{--vpc-spacing:22px;--vpc-icon-size:28px;--vpc-radius:26px;}ha-card.size-large .header-icon{width:54px;height:54px;border-radius:17px;}ha-card.size-large .name{font-size:18px;}ha-card.size-large .temp-hero-value{font-size:56px;letter-spacing:-3px;}ha-card.size-fullscreen{--vpc-spacing:28px;--vpc-icon-size:32px;--vpc-radius:28px;height:100%;min-height:80vh;}ha-card.size-fullscreen .header-icon{width:60px;height:60px;border-radius:19px;}ha-card.size-fullscreen .name{font-size:20px;}ha-card.size-fullscreen .temp-hero-value{font-size:68px;letter-spacing:-4px;}ha-card.animation-none{transition:none !important;}ha-card.animation-none:hover, ha-card.animation-none:active{transform:none !important;}ha-card.animation-subtle{transition:transform 0.15s ease, box-shadow 0.15s ease;}ha-card.animation-subtle:hover{transform:translateY(-1px);}ha-card.animation-smooth{transition:transform 0.25s cubic-bezier(0.34,1.4,0.64,1), box-shadow 0.25s ease;}ha-card.animation-energetic{transition:transform 0.2s cubic-bezier(0.34,1.6,0.64,1), box-shadow 0.2s ease;}ha-card.animation-energetic:hover{transform:translateY(-4px) scale(1.008);}@keyframes flow-gradient{0%{background-position:0% 50%;}100%{background-position:200% 50%;}}ha-card.flow-active .accent-bar{background:linear-gradient(90deg, var(--card-accent), color-mix(in srgb, var(--card-accent) 60%, white), var(--card-accent));background-size:200% 100%;animation:flow-gradient 2.5s linear infinite;}.error-state{display:flex;align-items:center;gap:14px;padding:20px;}.error-icon{width:46px;height:46px;border-radius:15px;display:flex;align-items:center;justify-content:center;background:color-mix(in srgb, var(--vpc-danger, #FF3B30) 10%, transparent);flex-shrink:0;}.error-icon ha-icon{--mdc-icon-size:24px;color:var(--vpc-danger, #FF3B30);}.error-info{display:flex;flex-direction:column;gap:3px;}.error-title{font-size:15px;font-weight:600;color:var(--vpc-danger, #FF3B30);letter-spacing:-0.2px;}.error-entity{font-size:12px;color:var(--vpc-text-secondary);font-family:'SF Mono', 'Fira Code', 'Cascadia Code', ui-monospace, monospace;opacity:0.7;}.system-grid{display:grid;grid-template-columns:repeat(auto-fit, minmax(300px, 1fr));gap:16px;}@media (max-width:600px){.chemistry-grid{grid-template-columns:repeat(3, 1fr);gap:6px;}.chemistry-card{padding:11px 6px 10px;}.chemistry-val{font-size:16px;}.system-grid{grid-template-columns:1fr;}.temp-hero-value{font-size:38px;letter-spacing:-1.5px;}.dosing-current-value{font-size:28px;}.speed-segment{font-size:11px;padding:8px 4px;}}@media (pointer:coarse){.speed-segment, .speed-off-btn, .device-row, .chemistry-card{min-height:44px;}}`}getCardSize(){switch(this.config?.card_type){case"compact":return 1;case"overview":return 5;default:return 3}}static getStubConfig(){return{type:"custom:violet-pool-card",entity_prefix:"violet_pool",entity:"switch.violet_pool_pump",card_type:"pump"}}static async getConfigElement(){return await Promise.resolve().then(function(){return w}),document.createElement("violet-pool-card-editor")}};r([a({attribute:!1})],b.prototype,"hass",void 0),r([o()],b.prototype,"config",void 0),b=r([s("violet-pool-card")],b),window.customCards=window.customCards||[],window.customCards.push({type:"violet-pool-card",name:"Violet Pool Card",description:"Premium card for Violet Pool Controller with glassmorphism design",preview:!0});let y=class extends e{setConfig(e){this._config=e}render(){return this.hass&&this._config?t` <div class="card-config"><!-- Card Type Selection --><div class="config-section"><div class="section-header"><ha-icon icon="mdi:card-outline"></ha-icon><span>Card Type</span></div><ha-select label="Card Type" .value="${this._config.card_type}" @selected="${this._cardTypeChanged}" @closed="${e=>e.stopPropagation()}" ><mwc-list-item value="pump">🔵 Pump</mwc-list-item><mwc-list-item value="heater">🔥 Heater</mwc-list-item><mwc-list-item value="solar">☀️ Solar</mwc-list-item><mwc-list-item value="dosing">💧 Dosing</mwc-list-item><mwc-list-item value="overview">📊 Overview</mwc-list-item><mwc-list-item value="compact">📋 Compact</mwc-list-item><mwc-list-item value="system">🖥️ System Dashboard</mwc-list-item></ha-select></div><!-- Controller Configuration --><div class="config-section"><div class="section-header"><ha-icon icon="mdi:chip"></ha-icon><span>Controller Configuration</span></div><ha-textfield label="Entity Prefix" .value="${this._config.entity_prefix||"violet_pool"}" @input="${this._entityPrefixChanged}" helper="Name of your pool controller (e.g., 'violet_pool', 'pool_1', 'garden_pool')" ></ha-textfield><div class="prefix-info"><ha-icon icon="mdi:information-outline"></ha-icon><span> The entity prefix should match your Violet Pool Controller name in Home Assistant. All entities will be automatically discovered based on this prefix. </span></div></div><!-- Entity Selection (not for overview/system) --> ${"overview"!==this._config.card_type&&"system"!==this._config.card_type?t`
              <div class="config-section">
                <div class="section-header">
                  <ha-icon icon="mdi:lightning-bolt"></ha-icon>
                  <span>Entity</span>
                </div>

                <ha-entity-picker
                  label="Entity"
                  .hass="${this.hass}"
                  .value="${this._config.entity}"
                  @value-changed="${this._entityChanged}"
                  allow-custom-entity
                ></ha-entity-picker>
              </div>
            `:""}

        <!-- Premium Design Options -->
        <div class="config-section premium-section">
          <div class="section-header premium-header">
            <ha-icon icon="mdi:palette"></ha-icon>
            <span>✨ Premium Design</span>
          </div>

          <!-- Size Picker -->
          <div class="picker-container">
            <label>Card Size</label>
            <div class="size-picker">
              ${["small","medium","large","fullscreen"].map(e=>t` <button class="size-button ${this._config.size===e?"active":""}" @click="${()=>this._sizeChanged(e)}" ><div class="size-preview size-${e}"></div><span>${this._formatSizeName(e)}</span></button> `)}
            </div>
          </div>

          <!-- Theme Picker -->
          <div class="picker-container">
            <label>Theme Style</label>
            <div class="theme-picker">
              ${[{value:"apple",icon:"",label:"Apple",desc:"Clean & Light",preview:"#fff"},{value:"dark",icon:"",label:"Dark",desc:"Deep Dark",preview:"#1C1C1E"},{value:"glass",icon:"",label:"Glass",desc:"Frosted Glass",preview:"rgba(255,255,255,0.7)"},{value:"modern",icon:"",label:"Modern",desc:"Minimal Flat",preview:"#f8f8fa"},{value:"minimalist",icon:"",label:"Minimal",desc:"Ultra Clean",preview:"#fff"},{value:"neon",icon:"",label:"Neon",desc:"Dark Glow",preview:"#0D0D14"}].map(e=>t` <button class="theme-button ${this._config.theme===e.value||!this._config.theme&&"apple"===e.value?"active":""}" @click="${()=>this._themeChanged(e.value)}" ><div class="theme-preview theme-${e.value}"><div class="theme-dot" style="background:${e.preview}"></div></div><div class="theme-info"><span class="theme-label">${e.label}</span><span class="theme-desc">${e.desc}</span></div></button> `)}
            </div>
          </div>

          <!-- Animation Picker -->
          <div class="picker-container">
            <label>Animation Level</label>
            <div class="animation-picker">
              ${[{value:"none",icon:"⏸️",label:"None",desc:"Static"},{value:"subtle",icon:"🌙",label:"Subtle",desc:"Professional"},{value:"smooth",icon:"✨",label:"Smooth",desc:"Balanced"},{value:"energetic",icon:"🚀",label:"Energetic",desc:"Dynamic"}].map(e=>t` <button class="animation-button ${this._config.animation===e.value?"active":""}" @click="${()=>this._animationChanged(e.value)}" ><span class="anim-icon">${e.icon}</span><div class="anim-info"><span class="anim-label">${e.label}</span><span class="anim-desc">${e.desc}</span></div></button> `)}
            </div>
          </div>
        </div>

        <!-- Basic Options -->
        <div class="config-section">
          <div class="section-header">
            <ha-icon icon="mdi:cog"></ha-icon>
            <span>Basic Options</span>
          </div>

          <ha-textfield
            label="Custom Name (optional)"
            .value="${this._config.name||""}"
            @input="${this._nameChanged}"
          ></ha-textfield>

          <ha-icon-picker
            label="Custom Icon (optional)"
            .hass="${this.hass}"
            .value="${this._config.icon||""}"
            @value-changed="${this._iconChanged}"
          ></ha-icon-picker>
        </div>

        <!-- Display Options -->
        <div class="config-section">
          <div class="section-header">
            <ha-icon icon="mdi:eye"></ha-icon>
            <span>Display Options</span>
          </div>

          <ha-formfield label="Show state badge">
            <ha-switch
              .checked="${!1!==this._config.show_state}"
              @change="${this._showStateChanged}"
            ></ha-switch>
          </ha-formfield>

          <ha-formfield label="Show detail status">
            <ha-switch
              .checked="${!1!==this._config.show_detail_status}"
              @change="${this._showDetailStatusChanged}"
            ></ha-switch>
          </ha-formfield>

          <ha-formfield label="Show controls">
            <ha-switch
              .checked="${!1!==this._config.show_controls}"
              @change="${this._showControlsChanged}"
            ></ha-switch>
          </ha-formfield>

          ${"pump"===this._config.card_type?t` <ha-formfield label="Show runtime counter"><ha-switch .checked="${!0===this._config.show_runtime}" @change="${this._showRuntimeChanged}" ></ha-switch></ha-formfield> `:""}

          ${"dosing"===this._config.card_type?t` <ha-formfield label="Show dosing history"><ha-switch .checked="${!0===this._config.show_history}" @change="${this._showHistoryChanged}" ></ha-switch></ha-formfield> `:""}
        </div>

        <!-- Dosing Type (for dosing cards) -->
        ${"dosing"===this._config.card_type?t` <div class="config-section"><div class="section-header"><ha-icon icon="mdi:flask"></ha-icon><span>Dosing Type</span></div><ha-select label="Dosing Type" .value="${this._config.dosing_type||"chlorine"}" @selected="${this._dosingTypeChanged}" @closed="${e=>e.stopPropagation()}" ><mwc-list-item value="chlorine">💧 Chlorine (ORP)</mwc-list-item><mwc-list-item value="ph_minus">➖ pH Minus</mwc-list-item><mwc-list-item value="ph_plus">➕ pH Plus</mwc-list-item><mwc-list-item value="flocculant">🌊 Flocculant</mwc-list-item></ha-select></div> `:""}

        <!-- Advanced Customization -->
        <details class="advanced-section">
          <summary>
            <ha-icon icon="mdi:tune"></ha-icon>
            <span>Advanced Customization</span>
          </summary>

          <div class="advanced-content">
            <ha-textfield
              label="Accent Color (hex)"
              .value="${this._config.accent_color||""}"
              placeholder="#2196F3"
              @input="${this._accentColorChanged}"
            ></ha-textfield>

            <ha-textfield
              label="Icon Color (hex)"
              .value="${this._config.icon_color||""}"
              placeholder="#2196F3"
              @input="${this._iconColorChanged}"
            ></ha-textfield>

            <ha-textfield
              type="number"
              label="Blur Intensity (0-30)"
              .value="${this._config.blur_intensity||10}"
              min="0"
              max="30"
              @input="${this._blurIntensityChanged}"
            ></ha-textfield>
          </div>
        </details>
      </div>
    `:t``}_formatSizeName(e){return{small:"Small",medium:"Medium",large:"Large",fullscreen:"Fullscreen"}[e]||e}_cardTypeChanged(e){const t=e.target;this._config.card_type!==t.value&&(this._config={...this._config,card_type:t.value},this._fireConfigChanged())}_entityPrefixChanged(e){const t=e.target.value.trim().toLowerCase().replace(/[^a-z0-9_]/g,"_");this._config.entity_prefix!==t&&(this._config={...this._config,entity_prefix:t||"violet_pool"},this._fireConfigChanged())}_entityChanged(e){const t=e.detail;this._config.entity!==t.value&&(this._config={...this._config,entity:t.value},this._fireConfigChanged())}_sizeChanged(e){this._config={...this._config,size:e},this._fireConfigChanged()}_themeChanged(e){this._config={...this._config,theme:e},this._fireConfigChanged()}_animationChanged(e){this._config={...this._config,animation:e},this._fireConfigChanged()}_nameChanged(e){this._config={...this._config,name:e.target.value||void 0},this._fireConfigChanged()}_iconChanged(e){this._config={...this._config,icon:e.detail.value||void 0},this._fireConfigChanged()}_showStateChanged(e){this._config={...this._config,show_state:e.target.checked},this._fireConfigChanged()}_showDetailStatusChanged(e){this._config={...this._config,show_detail_status:e.target.checked},this._fireConfigChanged()}_showControlsChanged(e){this._config={...this._config,show_controls:e.target.checked},this._fireConfigChanged()}_showRuntimeChanged(e){this._config={...this._config,show_runtime:e.target.checked},this._fireConfigChanged()}_showHistoryChanged(e){this._config={...this._config,show_history:e.target.checked},this._fireConfigChanged()}_dosingTypeChanged(e){this._config={...this._config,dosing_type:e.target.value},this._fireConfigChanged()}_accentColorChanged(e){this._config={...this._config,accent_color:e.target.value||void 0},this._fireConfigChanged()}_iconColorChanged(e){this._config={...this._config,icon_color:e.target.value||void 0},this._fireConfigChanged()}_blurIntensityChanged(e){this._config={...this._config,blur_intensity:parseInt(e.target.value)||10},this._fireConfigChanged()}_fireConfigChanged(){const e=new CustomEvent("config-changed",{detail:{config:this._config},bubbles:!0,composed:!0});this.dispatchEvent(e)}static get styles(){return i`:host{font-family:-apple-system, system-ui, 'Segoe UI', sans-serif;}.card-config{display:flex;flex-direction:column;gap:14px;padding:16px;}.config-section{background:var(--card-background-color, #fff);border:1px solid var(--divider-color, rgba(0,0,0,0.08));border-radius:14px;padding:16px;}.section-header{display:flex;align-items:center;gap:8px;margin-bottom:14px;font-weight:600;font-size:14px;letter-spacing:-0.2px;color:var(--primary-text-color);}.section-header ha-icon{--mdc-icon-size:18px;color:var(--primary-color);}.prefix-info{display:flex;align-items:flex-start;gap:8px;padding:10px 12px;margin-top:10px;background:rgba(0,122,255,0.07);border-radius:10px;font-size:12px;color:var(--secondary-text-color);line-height:1.4;}.prefix-info ha-icon{--mdc-icon-size:16px;color:#007AFF;flex-shrink:0;margin-top:2px;}.premium-section{background:var(--card-background-color, #fff);border:2px solid rgba(0,122,255,0.15);}.premium-header{color:#007AFF;}.picker-container{margin-bottom:20px;}.picker-container:last-child{margin-bottom:0;}.picker-container > label{display:block;font-weight:500;font-size:13px;margin-bottom:10px;color:var(--secondary-text-color);text-transform:uppercase;letter-spacing:0.5px;}.size-picker{display:grid;grid-template-columns:repeat(4,1fr);gap:6px;}.theme-picker{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;}.animation-picker{display:grid;grid-template-columns:repeat(2,1fr);gap:6px;}.size-button, .theme-button, .animation-button{display:flex;align-items:center;gap:10px;padding:10px;background:var(--secondary-background-color, rgba(120,120,128,0.06));border:1.5px solid transparent;border-radius:10px;cursor:pointer;transition:all 0.16s ease;font-family:inherit;}.size-button{flex-direction:column;gap:6px;align-items:center;}.theme-button{flex-direction:column;gap:6px;align-items:center;padding:10px 8px;}.size-button:hover, .theme-button:hover, .animation-button:hover{border-color:rgba(0,122,255,0.3);background:rgba(0,122,255,0.05);}.size-button.active, .animation-button.active{border-color:#007AFF;background:rgba(0,122,255,0.1);color:#007AFF;}.theme-button.active{border-color:#007AFF;background:rgba(0,122,255,0.08);box-shadow:0 0 0 3px rgba(0,122,255,0.15);}.size-preview{width:36px;height:26px;border-radius:6px;border:2px solid currentColor;opacity:0.3;}.size-preview.size-small{width:22px;height:18px;}.size-preview.size-medium{width:30px;height:22px;}.size-preview.size-large{width:40px;height:28px;}.size-preview.size-fullscreen{width:46px;height:34px;}.size-button.active .size-preview{opacity:1;}.size-button span{font-size:11px;font-weight:500;}.theme-preview{width:44px;height:44px;border-radius:12px;display:flex;align-items:center;justify-content:center;overflow:hidden;border:1px solid rgba(0,0,0,0.08);}.theme-preview.theme-apple{background:#F2F2F7;}.theme-preview.theme-dark{background:#1C1C1E;}.theme-preview.theme-glass{background:rgba(255,255,255,0.6);backdrop-filter:blur(8px);}.theme-preview.theme-modern{background:#f8f8fa;border:1px solid #eee;}.theme-preview.theme-minimalist{background:#fff;}.theme-preview.theme-neon{background:#0D0D14;border:1px solid rgba(0,212,255,0.3);}.theme-preview.theme-luxury{background:linear-gradient(135deg,rgba(255,255,255,0.9),rgba(240,240,255,0.9));}.theme-dot{width:20px;height:20px;border-radius:50%;border:2px solid rgba(0,0,0,0.1);}.theme-info, .anim-info{display:flex;flex-direction:column;gap:1px;}.theme-label, .anim-label{font-weight:600;color:var(--primary-text-color);font-size:12px;}.theme-desc, .anim-desc{color:var(--secondary-text-color);font-size:10px;}.anim-icon{font-size:18px;}.advanced-section{background:var(--card-background-color);border:1px solid var(--divider-color);border-radius:14px;padding:14px;}.advanced-section summary{display:flex;align-items:center;gap:8px;cursor:pointer;font-weight:600;font-size:14px;color:var(--primary-text-color);list-style:none;}.advanced-section summary::-webkit-details-marker{display:none;}.advanced-section summary ha-icon{--mdc-icon-size:18px;color:var(--primary-color);}.advanced-content{display:flex;flex-direction:column;gap:12px;margin-top:14px;}ha-select, ha-textfield, ha-entity-picker, ha-icon-picker{width:100%;}ha-formfield{display:flex;align-items:center;margin-bottom:10px;}`}};r([a({attribute:!1})],y.prototype,"hass",void 0),r([o()],y.prototype,"_config",void 0),y=r([s("violet-pool-card-editor")],y);var w=Object.freeze({__proto__:null,get VioletPoolCardEditor(){return y}});export{b as VioletPoolCard};
