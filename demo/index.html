<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Violet Pool Card Demo</title>
    <style>
      body {
        font-family: 'Roboto', 'Noto', sans-serif;
        background-color: #f5f5f5;
        padding: 20px;
        --card-background-color: white;
        --primary-text-color: #212121;
        --secondary-text-color: #757575;
        --disabled-text-color: #bdbdbd;
        --primary-color: #03a9f4;
        --secondary-background-color: #e0f7fa;
        --error-color: #f44336;
        --ha-card-border-radius: 12px;
        --ha-card-box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.14),
          0 1px 5px 0 rgba(0, 0, 0, 0.12), 0 3px 1px -2px rgba(0, 0, 0, 0.2);
      }
      .card-container {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
        max-width: 1200px;
        margin: 0 auto;
        margin-bottom: 40px;
      }
      .card-wrapper {
        flex: 1 1 350px;
        min-width: 300px;
        max-width: 500px;
      }
      h2 {
        text-align: center;
        color: #333;
        margin-top: 40px;
      }
      h3 {
        text-align: center;
        color: #666;
        font-weight: normal;
      }
    </style>
  </head>
  <body>
    <!-- Premium Theme Gallery -->
    <h2>Premium Theme Gallery</h2>

    <h3>Luxury Theme (Default) - Large Pump</h3>
    <div class="card-container">
      <div class="card-wrapper" style="flex-basis: 100%; max-width: 600px;">
        <violet-pool-card id="luxury-pump-large"></violet-pool-card>
      </div>
    </div>

    <h3>Modern Theme - Medium Heater</h3>
    <div class="card-container">
      <div class="card-wrapper">
        <violet-pool-card id="modern-heater-medium"></violet-pool-card>
      </div>
    </div>

    <h3>Glass Theme - Large Solar</h3>
    <div class="card-container">
      <div class="card-wrapper" style="flex-basis: 100%; max-width: 600px;">
        <violet-pool-card id="glass-solar-large"></violet-pool-card>
      </div>
    </div>

    <h3>Neon Theme - Medium Dosing</h3>
    <div class="card-container">
      <div class="card-wrapper">
        <violet-pool-card id="neon-dosing-medium"></violet-pool-card>
      </div>
    </div>

    <h3>Premium Theme - Fullscreen Pump</h3>
    <div class="card-container" style="max-width: 100%;">
      <div class="card-wrapper" style="flex-basis: 100%; max-width: 100%;">
        <violet-pool-card id="premium-pump-fullscreen"></violet-pool-card>
      </div>
    </div>

    <!-- Card Types -->
    <h2>Card Types</h2>
    <div class="card-container">
      <div class="card-wrapper">
        <violet-pool-card id="pump-card"></violet-pool-card>
      </div>
      <div class="card-wrapper">
        <violet-pool-card id="heater-card"></violet-pool-card>
      </div>
      <div class="card-wrapper">
        <violet-pool-card id="solar-card"></violet-pool-card>
      </div>
      <div class="card-wrapper">
        <violet-pool-card id="dosing-card"></violet-pool-card>
      </div>
      <div class="card-wrapper" style="flex-basis: 100%; max-width: 100%;">
        <violet-pool-card id="overview-card"></violet-pool-card>
      </div>
      <div class="card-wrapper">
        <violet-pool-card id="compact-card"></violet-pool-card>
      </div>
    </div>

    <!-- Examples -->
    <h2>Examples</h2>

    <h3>Fullscreen Premium System</h3>
    <div class="card-container" style="max-width: 100%;">
      <div class="card-wrapper" style="flex-basis: 100%; max-width: 100%;">
        <violet-pool-card id="system-fullscreen-premium"></violet-pool-card>
      </div>
    </div>

    <h3>Large Overview (Luxury)</h3>
    <div class="card-container">
      <div class="card-wrapper" style="flex-basis: 100%; max-width: 800px;">
        <violet-pool-card id="overview-luxury-large"></violet-pool-card>
      </div>
    </div>

    <h3>Compact Modern Dashboard</h3>
    <div class="card-container" style="max-width: 400px;">
      <div class="card-wrapper" style="flex-basis: 100%;">
        <violet-pool-card id="compact-modern-pump-small"></violet-pool-card>
        <div style="height: 10px;"></div>
        <violet-pool-card id="compact-modern-heater-small"></violet-pool-card>
        <div style="height: 10px;"></div>
        <violet-pool-card id="compact-modern-solar-small"></violet-pool-card>
      </div>
    </div>

    <script type="module">
      import { VioletPoolCard } from '../dist/violet-pool-card.js';

      const baseHass = {
        states: {
          'switch.violet_pool_pump': {
            entity_id: 'switch.violet_pool_pump',
            state: 'on',
            attributes: {
              friendly_name: 'Pool Pump',
              PUMPSTATE: '2|OK',
              PUMP_RPM_0: 0,
              PUMP_RPM_1: 1500,
              PUMP_RPM_2: 2200,
              PUMP_RPM_3: 2800,
              runtime: 9240
            }
          },
          'climate.violet_pool_heater': {
            entity_id: 'climate.violet_pool_heater',
            state: 'heating',
            attributes: {
              friendly_name: 'Pool Heater',
              HEATERSTATE: 'OK',
              current_temperature: 24.5,
              temperature: 28.0,
              min_temp: 18,
              max_temp: 35,
              outside_temperature: 22.1,
              min_outside_temperature: 14.5
            }
          },
          'climate.violet_pool_solar': {
            entity_id: 'climate.violet_pool_solar',
            state: 'auto',
            attributes: {
              friendly_name: 'Solar Heating',
              SOLARSTATE: 'WAITING_FOR_TEMP_DIFF',
              absorber_temperature: 45.2,
              current_temperature: 24.5,
              temperature: 30.0,
              min_temp: 18,
              max_temp: 32
            }
          },
          'switch.violet_pool_dos_1_cl': {
            entity_id: 'switch.violet_pool_dos_1_cl',
            state: 'on',
            attributes: {
              friendly_name: 'Chlorine Dosing',
              DOS_1_CL_STATE: ['ACTIVE'],
              dosing_volume_24h: 150
            }
          },
          'switch.violet_pool_dos_2_phm': {
            entity_id: 'switch.violet_pool_dos_2_phm',
            state: 'auto',
            attributes: {
                friendly_name: 'pH Minus',
                DOS_2_PHM_STATE: [],
                dosing_volume_24h: 50
            }
          },
          'sensor.violet_pool_orp_value': {
            entity_id: 'sensor.violet_pool_orp_value',
            state: '650',
            attributes: { unit_of_measurement: 'mV' }
          },
          'number.violet_pool_target_orp': {
            entity_id: 'number.violet_pool_target_orp',
            state: '700',
            attributes: { min: 600, max: 800 }
          },
          'sensor.violet_pool_ph_value': {
            entity_id: 'sensor.violet_pool_ph_value',
            state: '7.2',
            attributes: { unit_of_measurement: 'pH' }
          },
          'number.violet_pool_target_ph': {
            entity_id: 'number.violet_pool_target_ph',
            state: '7.2',
            attributes: { min: 6.8, max: 7.8 }
          },
          'sensor.violet_pool_temperature': {
             entity_id: 'sensor.violet_pool_temperature',
             state: '24.5',
             attributes: { unit_of_measurement: 'Â°C' }
          }
        },
        callService: async (domain, service, data) => {
          console.log(`Called service ${domain}.${service}`, data);
        }
      };

      // Helper to create a new hass object with overrides
      const createMockHass = (overrides = {}) => {
        // Deep clone the base hass object
        const newHass = JSON.parse(JSON.stringify(baseHass));
        newHass.callService = baseHass.callService;

        // Apply overrides
        for (const [entityId, stateObj] of Object.entries(overrides)) {
          if (newHass.states[entityId]) {
            const { attributes: newAttributes, ...otherStateProps } = stateObj;
            newHass.states[entityId] = { ...newHass.states[entityId], ...otherStateProps };
             // Merge attributes if provided
             if (newAttributes) {
                newHass.states[entityId].attributes = { ...newHass.states[entityId].attributes, ...newAttributes };
             }
          }
        }
        return newHass;
      };

      // Helper to configure card
      const configureCard = (id, config, stateOverrides = {}) => {
        const el = document.getElementById(id);
        if (el) {
          el.setConfig({
            type: 'custom:violet-pool-card',
            ...config
          });
          el.hass = createMockHass(stateOverrides);
        }
      };

      // --- Premium Theme Gallery ---

      // Luxury Theme (Default) - Large Pump
      // High Speed, Active
      configureCard('luxury-pump-large', {
        entity: 'switch.violet_pool_pump',
        card_type: 'pump',
        size: 'large',
        theme: 'luxury',
        animation: 'smooth'
      }, {
        'switch.violet_pool_pump': {
            state: 'on',
            attributes: { PUMPSTATE: '3|OK', runtime: 15400 } // Speed 3, longer runtime
        }
      });

      // Modern Theme - Medium Heater
      // Heating actively
      configureCard('modern-heater-medium', {
        entity: 'climate.violet_pool_heater',
        card_type: 'heater',
        size: 'medium',
        theme: 'modern',
        animation: 'subtle'
      }, {
         'climate.violet_pool_heater': {
            state: 'heating',
            attributes: { current_temperature: 26.0, temperature: 29.0 }
         }
      });

      // Glass Theme - Large Solar
      // Active Solar
      configureCard('glass-solar-large', {
        entity: 'climate.violet_pool_solar',
        card_type: 'solar',
        size: 'large',
        theme: 'glass',
        animation: 'smooth'
      }, {
        'climate.violet_pool_solar': {
            state: 'auto',
            attributes: { SOLARSTATE: 'ACTIVE', absorber_temperature: 55.0 }
        }
      });

      // Neon Theme - Medium Dosing
      // Warning State
      configureCard('neon-dosing-medium', {
        entity: 'switch.violet_pool_dos_1_cl',
        card_type: 'dosing',
        size: 'medium',
        theme: 'neon',
        animation: 'energetic'
      }, {
         'switch.violet_pool_dos_1_cl': {
             state: 'on',
             attributes: { DOS_1_CL_STATE: ['ALARM_LEVEL'], dosing_volume_24h: 300 }
         }
      });

      // Premium Theme - Fullscreen Pump
      // Error State
      configureCard('premium-pump-fullscreen', {
        entity: 'switch.violet_pool_pump',
        card_type: 'pump',
        size: 'fullscreen',
        theme: 'premium',
        animation: 'energetic'
      }, {
          'switch.violet_pool_pump': {
              state: 'off',
              attributes: { PUMPSTATE: 'ERROR', runtime: 0 }
          }
      });

      // --- Card Types ---

      // Default Pump
      configureCard('pump-card', {
        entity: 'switch.violet_pool_pump',
        card_type: 'pump',
        show_runtime: true
      });

      // Default Heater (Idle)
      configureCard('heater-card', {
        entity: 'climate.violet_pool_heater',
        card_type: 'heater'
      }, {
          'climate.violet_pool_heater': {
              state: 'off',
              attributes: { HEATERSTATE: 'OFF', current_temperature: 28.0, temperature: 28.0 }
          }
      });

      // Default Solar (Waiting)
      configureCard('solar-card', {
        entity: 'climate.violet_pool_solar',
        card_type: 'solar'
      });

      // Default Dosing
      configureCard('dosing-card', {
        entity: 'switch.violet_pool_dos_1_cl',
        card_type: 'dosing',
        dosing_type: 'chlorine',
        show_history: true
      });

      // Overview
      configureCard('overview-card', {
        card_type: 'overview'
      }, {
          'sensor.violet_pool_orp_value': { state: '750' },
          'sensor.violet_pool_ph_value': { state: '7.4' }
      });

      configureCard('compact-card', {
        entity: 'switch.violet_pool_pump',
        card_type: 'compact'
      });

      // --- Examples ---

      // Fullscreen Premium System
      // Everything running perfectly
      configureCard('system-fullscreen-premium', {
        entity: 'switch.violet_pool_pump',
        card_type: 'system',
        size: 'fullscreen',
        theme: 'premium',
        animation: 'energetic'
      }, {
          'switch.violet_pool_pump': { state: 'on', attributes: { PUMPSTATE: '2|OK' } },
          'climate.violet_pool_heater': { state: 'heating' },
          'climate.violet_pool_solar': { state: 'auto', attributes: { SOLARSTATE: 'ACTIVE' } },
          'sensor.violet_pool_temperature': { state: '26.5' }
      });

      // Large Overview (Luxury)
      configureCard('overview-luxury-large', {
        card_type: 'overview',
        name: 'Pool Status',
        size: 'large',
        theme: 'luxury',
        animation: 'smooth'
      }, {
         'sensor.violet_pool_temperature': { state: '27.0' }
      });

      // Compact Modern Dashboard
      configureCard('compact-modern-pump-small', {
        entity: 'switch.violet_pool_pump',
        card_type: 'compact',
        size: 'small',
        theme: 'modern'
      }, {
          'switch.violet_pool_pump': { state: 'on', attributes: { PUMPSTATE: '1|OK', runtime: 1200 } }
      });

      configureCard('compact-modern-heater-small', {
        entity: 'climate.violet_pool_heater',
        card_type: 'compact',
        size: 'small',
        theme: 'modern'
      }, {
          'climate.violet_pool_heater': { state: 'heating' }
      });

      configureCard('compact-modern-solar-small', {
        entity: 'climate.violet_pool_solar',
        card_type: 'compact',
        size: 'small',
        theme: 'modern'
      }, {
          'climate.violet_pool_solar': { state: 'auto', attributes: { SOLARSTATE: 'ACTIVE' } }
      });

    </script>
  </body>
</html>